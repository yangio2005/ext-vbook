<head>
    <link rel="dns-prefetch" href="//static.sangtacvietcdn.xyz">
    <link rel="shortcut icon" type="image/png" href="/favicon.png" />
    <meta http-equiv="Content-Language" content="vi-vn">
    <meta name="robots" content="noindex, nofollow">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noindex, nofollow" />
    <link rel="canonical" href="https://sangtacviet.vip/truyen/ciweimao/1/100464209/114386813/">
    <meta charset="utf-8">
    <title>Sáng Tác Việt - Nền tảng văn học mạng mở mới</title>
    <meta name="keywords" content="tấn giang,đọc truyện,faloo,ciweimao,truyện full,qidian,sfacg,khởi điểm">
    <meta name="description" content="Nền tảng đọc truyện tự do, tự dịch truyện, đọc miễn phí một số nguồn vip.">
    <meta property="og:description" content="Đọc truyện scan, truyện free, tự động dịch truyện...">
    <meta property="og:title" content="Sáng Tác Việt">
    <meta property="og:type" content="novel">
    <meta property="og:image" property="https://sangtacviet.com/favicon.png">
    <script type="text/javascript">
        if (location.hash.indexOf("rtc") >= 0) {
            location.hash = "";
        }
        if (location.hash.indexOf("showerror") >= 0) {
            window.onerror = function (msg, url, lineNo, columnNo, error) {
                alert(msg + "\n" + url + "\n" + columnNo + "\n" + lineNo);
            }
        }
        //const isInStandaloneMode = () =>
        //    (window.matchMedia('(display-mode: standalone)').matches) || (window.navigator.standalone) || document.referrer.includes//('android-app://');
        // 	if (isInStandaloneMode()) {
        // 		ui.appmode();
        //}

    </script>
    <script src="/jqr.js"></script>
    <link rel="stylesheet" href="/bootstrap.min.css?origin=">
    <link rel="stylesheet" href="/font/font.css?v=4">
    <link rel="stylesheet" href="/asset/all.min.css">
    <link rel="stylesheet" type="text/css" href="/main.css?v=7">
    <link rel="stylesheet" type="text/css" href="/asset/theme.default.css?v=0">
    <style type="text/css">
        .fa-download {
            min-width: 30px;
            font-size: 30px;
        }

        .cgcolor {
            font-size: 15px;
            line-height: 1.2;
            width: 25px;
            text-align: center;
        }

        .noti {
            padding: 0 6px;
            height: 60px;
            border: 1px solid #dddddd;
            margin-top: -1px;
        }

        .noti h6 {
            margin: 6px 0 0 0;
            font-size: 14px;
        }

        #searchbox {
            line-height: 2;
        }

        #commentportion .sec-bot {
            border-bottom-left-radius: 4px;
            border-bottom-right-radius: 4px;
        }

        .blk-item2 {
            display: block;
            font-size: 12px;
            font-weight: 600;
            padding: 10px;
            text-align: center;
        }

        .blk-item2 i {
            font-size: 30px;
        }

        .col-3 {
            padding: 0;
        }

        .blk-item2 i:after {
            content: "";
            display: block;
        }

        .nip {
            border: none;
            background-color: #eee;
            outline: none;
            padding: 4px;
            border-radius: 6px;
        }

        .nip {
            border: none;
            width: 100%;
            background: #eee;
            padding: 6px;
            border-radius: 6px;
            outline: none;
        }
    </style>
    <script type="text/javascript" src="/stv.ui.js?v=1.283"></script>
    <script type="text/javascript">
        window.onerror = function (msg, url, lineNo, columnNo, error) {
            if (!(msg.contain("is not a")) && !(msg.contain("ghz is not defined")) && !(msg.contain("find variable: ghz"))) {
                if (url.join) {
                    url = url.join(",");
                }
                if (error && error.stack) {
                    msg += "\n" + error.stack;
                }
                ajax("sajax=reportscripterror&data=" + encodeURIComponent(msg) + "&file=" + encodeURIComponent(url) + "&line=" + lineNo + ":" + columnNo, function () { });
            }
        }
    </script>
    <script src="/hanviet.js?ver=6"></script>
    <script src="/qtOnline.js?ver=3503" onerror="this.src='/qtOnline.js?ver=3452&error=1'"></script>
    <script src="/bootstrap.min.js"></script>
    <script src="/stv.host.js?v=035"></script>
    <script>
        //perf fix
        var oldReg = RegExp;
        window.RegExp = function (a) {
            if (a && a.indexOf) {
                if (a.indexOf("cloudfront") < 0) {
                    return oldReg.apply(this, arguments);
                }
                return new oldReg();
            }
            return oldReg.apply(this, arguments);
        }

        var userperm = 1; var isMobile = false;
        // device detection
        if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)
            || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0, 4))) {
            isMobile = true;
        }
        var store = window.localStorage;
        function getCookie(cname) {
            var name = cname + "=";
            //var decodedCookie = decodeURIComponent(document.cookie);
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                try {
                    var c = decodeURIComponent(ca[i]);
                    while (c.charAt(0) == ' ') {
                        c = c.substring(1);
                    }
                    if (c.indexOf(name) == 0) {
                        return c.substring(name.length, c.length);
                    }
                } catch (e) {
                    console.log('Cookie error: ' + ca[i]);
                }
            }
            return "";
        }
        function timeElapsed(time, suffix) {
            if (!time) { return " "; }
            var btime = time;
            if (time.indexOf("GMT") <= 0) {
                time = time + " GMT+0700";
            }
            var timedifsec = (new Date().getTime() - new Date(time).getTime()) / 1000;

            if (!timedifsec) {
                return btime;
            }
            var timedif = {
                second: Math.floor(timedifsec)
                , minute: Math.floor(timedifsec / 60)
                , hour: Math.floor(timedifsec / 3600)
                , day: Math.floor(timedifsec / 86400)
                , week: Math.floor(timedifsec / 604800)
            }
            if (!suffix) {
                return timedif;
            } else {
                if (timedif.week > 0) {
                    return timedif.week + " tuần trước";
                } else
                    if (timedif.day > 0) {
                        return timedif.day + " ngày trước";
                    } else
                        if (timedif.hour > 0) {
                            return timedif.hour + " giờ trước";
                        } else
                            if (timedif.minute > 0) {
                                return timedif.minute + " phút trước";
                            } else
                                if (timedif.second < 1) {
                                    return "vừa mới";
                                } else return timedif.second + " giây trước";
            }
        }
        function jumpPage() {
            if (typeof (thispage) == "undefined") return;
            if (window.setting.nofastnav) return;
            var event = document.all ? window.event : arguments[0];
            try {
                if (event.keyCode == 37) document.getElementById("navprevtop").click();
                //if (event.keyCode== 82) gotox();
                if (event.keyCode == 39) document.getElementById("navnexttop").click();
            } catch (e) { }

        }
        document.onkeydown = jumpPage;
        function enmobile() {
            if (isMobile) {
                g("namewdf").style.width = "100%";
            }
        }
        function parseid() {
            var sp = g("hiddenid").innerHTML.split(";");
            return { bookid: sp[0], host: sp[2], chapter: sp[1] }
        }
        var namew;
        document.addEventListener("DOMContentLoaded", function (event) {
            loadConfig();
            try {
                enmobile();
            } catch (c) { }
            namew = document.getElementById("namewd");
            try {
                excute();
            } catch (c) { }
            if (window.applyNodeList) {
                defineSys();
            }
        });
        loadConfig();
    </script>
</head>

<body>
    <div id="full">
        <div id="tm-top-nav">
            <div class="container">
                <a id="tm-top-nav-home" style="color: grey" href="/">Trang chủ</a> |
                <a id="tm-top-nav-fanpage" href="https://www.facebook.com/105795507712320/"
                    style="color: grey">Fanpage</a> |
                <a id="tm-top-nav-forum" href="/forum/" style="color: grey">Diễn đàn</a>
            </div>
        </div>
        <nav class="navbar navbar-expand-lg bg-light" id="mainbar">
            <div id="tm-nav-search-top" class="container" style="display:block;line-height: 50px;">
                <a href="/"><img alt="Logo sangtacviet" id="tm-nav-search-logo" src="/favicon.png"></a>
                <div id="tm-nav-search-top-right" style="float: right;">
                    <button type="button" class="btn" id="notifmarker" onclick="notification()"><i
                            class="fas fa-exclamation"></i>
                    </button>
                    <img id="tm-user-avatar" src="https://static.sangtacvietcdn.xyz/img/useravatar/default.png"
                        onclick="usermenu()">
                    <span id="usermenupos" style="position: relative;height: 30px;display: inline-block;">
                        <div id="menunavigator2" style="display: none;line-height:min(50px, 12vw);">
                            <ul style="list-style-type: none;padding: 6px;white-space: nowrap;display: block;">
                                <span style="margin: 8px;text-align: center;padding: 6px;">@u_329882</span>
                                <hr>
                                <li><a onclick="ui.swiftload(this)" href="/user/0/">Thông tin cá nhân</a></li>
                                <li><a onclick="ui.swiftload(this)" href="/setting/">Cài đặt</a></li>
                                <li><a onclick="ui.swiftload(this)" href="/the-luc/">Thế lực</a></li>
                                <li><a onclick="logout();">Đăng xuất</a></li>
                                <hr hidden="">
                                <li><a href="/donate/" style="color: #DD0000">Donate</a></li>
                                <hr>
                                <li><a onclick="ui.swiftload(this,'inner')" href="/mybook/">Truyện đánh dấu</a></li>
                                <li><a onclick="ui.swiftload(this,'inner')" href="/readed/">Truyện đã đọc</a></li>
                                <li><a onclick="ui.swiftload(this,'inner')" href="/following/">Truyện theo dõi</a></li>
                                <li hidden><a onclick="ui.swiftload(this,'inner')" href="/de-cu/">Truyện đề cử</a></li>
                                <li><a onclick="ui.swiftload(this,'inner')" href="/nhunger/">Truyện tôi thầu</a></li>
                                <hr>
                                <li><a href="/uploader/" style="color: #DD0000">Đăng truyện</a></li>
                                <li><a href="/writer.php">Khu tác giả</a></li>
                                <li><a href="/langer.php">[PC-Only]Khu dịch giả</a></li>

                            </ul>
                        </div>
                        <script type="text/javascript">
                            function closeusermenu() {
                                g("menunavigator2").style.display = "none";
                                ismenu2show = false;
                            }
                            var ismenu2show = false;
                            function usermenu() {
                                var a = g("usermenupos");
                                if (ismenu2show) {
                                    a.children[0].style.display = "none";
                                    ismenu2show = false;
                                } else {
                                    a.children[0].style.display = "block";
                                    ismenu2show = true;
                                }

                            }
                            function logout() {
                                if (!confirm("Xác nhận thoát tài khoản?")) {
                                    return;
                                }
                                var params = "ajax=logout&ngmar=logout";
                                var http = new XMLHttpRequest();
                                var url = '/index.php';
                                http.open('POST', url, true);
                                http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                                http.onreadystatechange = function () {
                                    if (http.readyState == 4 && http.status == 200) {
                                        if (http.responseText == "success") document.location.href = "/";
                                    }
                                }
                                http.send(params);
                            }
                        </script>
                    </span>
                </div>
                <form class="" style="width:auto;margin: 0">
                    <div class="input-group">
                        <input id="id" autocomplete="off" class="form-control col-auto"
                            onkeydown="if(event.keyCode==13){event.preventDefault();goto();}" type="text" name="id"
                            placeholder="Link truyện/Tìm kiếm">
                        <button id="tm-btn-goto" aria-label="Nút tìm kiếm" type="button"
                            class="my-0 my-lg-0 fas fa-arrow-right" onclick="goto()"></button>
                        <button id="tm-btn-rescan" aria-label="Nút tải lại" type="button"
                            class="my-0 my-lg-0 fas fa-redo" onclick="gotox()"></button>
                        <span id="tm-nav-search-popup" style="display: block;">
                            <div id="searchbox">
                            </div>
                        </span>

                    </div>
                    <script type="text/javascript">
                        var _c = "_gac", _d = "_gid", c = getCookie, _h = "charCodeAt";
                    </script>
                </form>
            </div>
        </nav>
        <div id="tm-bot-nav" class="bg-dark">
            <div id="naviga" class="container">
                <a onclick="ui.swiftload(this)" href="/"><i class="fas fa-home"></i> Trang chủ</a>
                <a onclick="ui.swiftload(this)" href="/truyen-ngon/"><i class="fas fa-comment"></i> Thế giới</a>
                <a onclick="ui.swiftload(this)" href="/search/">Tìm Truyện</a>
                <a href="/day-sach/">Đẩy Sách</a>
                <a href="/surf.php">Dịch trang web</a>
                <a onclick="ui.swiftload(this)" href="/trans/">Dịch</a>

            </div>
        </div>
        <div id="shownbtnctn"></div>
        <div id="inner">

            <div hidden data-nosnippet class="container bg-light"
                style="display: block;font-size: 14px;color: gray;padding: 6px 16px; border-left: 4px solid red">
                Truy cập <a style="-animation: color-change 1.5s linear infinite; /*Fix lỗi user bị mù*/"
                    href="https://sangtacviet.app">sangtacviet.app</a> nếu bạn không thể truy cập trang web.
            </div>
            <div data-nosnippet class="container bg-light"
                style="display: block;font-size: 14px;color: gray;padding: 6px 16px; border-left: 4px solid red">
                Cáp biển APG đã bị hỏng, truy cập website có thể bị chậm. Giờ cao điểm buổi tối nhà mạng sẽ điều chỉnh
                băng thông khiến bạn có khả năng không truy cập được.
            </div>
            <script>(function () { var _0x489fc5 = _0x5725; function _0x1259() { var _0x5dd741 = ['split', '4417TdFCpj', 'String', 'join', '726iYXZUk', '271596ZsWYDM', '983338lyRjuv', '49132dsyGXi', 'fromCharCode', '8378088YihXbr', 'XMLHttpRequest', 'concat', '483516hbyhlK', 'atob', '1901910OdKCPj', 'slice']; _0x1259 = function () { return _0x5dd741; }; return _0x1259(); } function _0x5725(_0x56ab88, _0x3fc0fe) { var _0x125991 = _0x1259(); return _0x5725 = function (_0x57259c, _0xb620bb) { _0x57259c = _0x57259c - 0x9b; var _0x1c19f3 = _0x125991[_0x57259c]; return _0x1c19f3; }, _0x5725(_0x56ab88, _0x3fc0fe); } (function (_0x175fb7, _0x3afa65) { var _0x100b99 = _0x5725, _0x5aa1d3 = _0x175fb7(); while (!![]) { try { var _0x59ab52 = -parseInt(_0x100b99(0xa4)) / 0x1 + -parseInt(_0x100b99(0xa3)) / 0x2 + parseInt(_0x100b99(0xa9)) / 0x3 + parseInt(_0x100b99(0xa2)) / 0x4 + -parseInt(_0x100b99(0x9b)) / 0x5 + parseInt(_0x100b99(0xa1)) / 0x6 * (-parseInt(_0x100b99(0x9e)) / 0x7) + parseInt(_0x100b99(0xa6)) / 0x8; if (_0x59ab52 === _0x3afa65) break; else _0x5aa1d3['push'](_0x5aa1d3['shift']()); } catch (_0x31bac6) { _0x5aa1d3['push'](_0x5aa1d3['shift']()); } } }(_0x1259, 0x4410e), function (_0x1e8bc6, _0x5df413, _0x5f5bba, _0x4e126d, _0x4498da, _0x1ebf49, _0x538fea, _0x26e80a, _0xccadcd, _0x1f7779) { var _0x4d4e2c = _0x5725; function _0x5b0c48() { var _0x152750 = function (_0xd81091) { return _0xd81091; }([0x51, 0x58, 0x37, 0x6e, 0x67, 0x72, 0x3f, 0x77, 0x62, 0x4a, 0x47, 0x48]); return _0x152750; } var _0x1d170c = _0x4d4e2c(0xaa); for (var _0x4871ed = 0x0; _0x4871ed < 0x24; _0x4871ed += 0x3) { var _0x96eed9 = _0x4871ed / 0x3; _0x4871ed > 0x20 && (_0x1e8bc6[_0x1e8bc6[_0x1d170c[_0x5df413]('')[_0x5f5bba](0x0, 0x4)[_0x4e126d]('')](_0x1d170c[_0x5df413]('')[_0x5f5bba](0x4)[_0x538fea]([_0x26e80a])[_0x4e126d](''))] && (_0x1e8bc6[_0xccadcd][_0x1f7779]['send'] = function () { void 0x0; })), _0x1d170c += _0x1e8bc6[_0x4498da][_0x1ebf49](_0x5b0c48()[_0x96eed9] - _0x4871ed / 0x3); } }(window, _0x489fc5(0x9d), _0x489fc5(0x9c), _0x489fc5(0xa0), _0x489fc5(0x9f), _0x489fc5(0xa5), _0x489fc5(0xa8), '=', _0x489fc5(0xa7), 'prototype')); })();</script>
            <script type="text/javascript">document.cookie = "_gac=32aaa066cdd2eddf82f84c088eabd2efpFlbLrJLTP+bKfcdtF2Gv/t9IfN1XyxXf1bEWrucYntpVFIkvF/uDa8Otb16bXXMold2aUwH0LLPEImpxhnD5B3y6x4XMxBE5MQ=; path=/"; var contentcontainer = "maincontent"; function settransmode(mode, noreload) {
                    var d = new Date();
                    d.setTime(d.getTime() + (365 * 24 * 60 * 60 * 1000));
                    var expires = "expires=" + d.toUTCString();
                    document.cookie = "transmode=" + mode + ";" + expires + ";path=/";
                    if (!noreload) {
                        setTimeout(function () {
                            location.reload();
                        }, 4000);
                    }
                }
                function settranslang(mode, noreload) {
                    var d = new Date();
                    d.setTime(d.getTime() + (365 * 24 * 60 * 60 * 1000));
                    var expires = "expires=" + d.toUTCString();
                    document.cookie = "foreignlang=" + mode + ";" + expires + ";path=/";
                    if (!noreload) {
                        setTimeout(function () {
                            location.reload();
                        }, 4000);
                    }
                }
                var state = "8285b3b467469f8fd07ba13513a90b05"; // key version to use
            </script>

            <style type="text/css">
                .contentbox img {
                    display: block;
                    margin: 4 auto;
                    max-width: 100%;
                }

                .comicpage {
                    width: 100%;
                    border: none;
                    position: sticky;
                    height: 100vh;
                }
            </style>
            <span id='hiddenid' hidden>100464209;114386813;ciweimao</span><br>

            <div class="container bg-light tm-reader-top-br" id="breadcum"
                style="font-size: 14px;color: gray;padding: 6px 16px;">_</div>
            <br class="tm-reader-top-br">
            <a href="/truyen/ciweimao/1/100464209/" id="booknameholder"
                style="font-size: 24px;font-weight: 700;color: gray;display: block;text-align: center;">_</a>
            <center id="bookchapnameholder" style="color: gray">_</center>
            <br>
            <div class="tm-reader-top-nav" style="background: #eeeeee;font-size: 16px;padding: 6px 0;font-weight: 500">
                <div class="container" style="text-align: center;">
                    <a onclick="blinkloadnextchap(true)" id="navprevtop" href=""
                        style="display: inline-block;float: left;"><i class="fas fa-chevron-left"></i> Chương trước</a>
                    <a id="navcentertop" href="/truyen/ciweimao/1/100464209/"> Mục lục </a>
                    <a onclick="blinkloadnextchap()" id="navnexttop" href=""
                        style="display: inline-block;float: right;">Chương sau <i class="fas fa-chevron-right"></i></a>
                </div>
            </div>
            <div class="contentbox" style="height: 0;display: none;">
                Đọc trên web để có chất lượng dịch cao và ủng hộ website.
            </div>
            <div id="content-container" class="container" style="min-height: 300px;padding: 0px;">
                <div class="contentbox" style='font-family:arial;padding: 24px;font-size:18px;' id='maincontent'
                    cid="114386813" user="329882">
                    <br>
                    <center><span class="spinner-border"></span><br>
                        Đang tải nội dung chương... </center>
                    <br>
                    <script async type="text/javascript">
                        try {
                            if (location.hash) {
                                if (location.hash.match && location.hash.match(/settransmode=(name|chinese)/)) {
                                    settransmode(/settransmode=(name|chinese)/.exec(location.hash)[1], true);
                                }
                                if (location.hash.match && location.hash.match(/settranslang=(vi|en|.....)/)) {
                                    settranslang(/settranslang=(vi|en|.....)/.exec(location.hash)[1], true);
                                }
                            }
                        } catch (ss) { }
                        var noscale = q('meta[name="viewport"]')[0];
                        noscale.setAttribute("content", "width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no");
                        var chapcache = {};
                        var bookid = "100464209";
                        var currentid = "114386813";
                        var bookhost = "ciweimao";
                        if (bookhost == "sangtac" || bookhost == "dich") {
                            window.lockCtp = true;
                            if (window.fontfam) {
                                g("maincontent").style.fontFamily = window.fontfam;
                            } else {
                                g("maincontent").style.fontFamily = 'nunito';
                            }

                        }
                        if (["faloo", "dich", "sangtac"].indexOf(bookhost) >= 0) {
                            addEventListener('DOMContentLoaded', (event) => {
                                q("#configBox button")[0].style.display = "none";
                            });
                        }
                        if (bookhost == "faloo") {
                            window.lockCtp = true;
                            if (window.fontfam) {
                                g("maincontent").style.fontFamily = window.fontfam;
                            } else {
                                g("maincontent").style.fontFamily = 'stvarial';
                            }
                        }
                        var booksty = 1;
                        var currentidc = '';
                        var chapterfetcher = new XMLHttpRequest();
                        var tmpctn = document.createElement("div");
                        var timerout = setTimeout(function () {
                            if (chapterfetcher.readyState == 1) { return; }
                            if (bookhost != "qidian") {
                                g("maincontent").innerHTML = "<center>Tải quá thời gian, vui lòng tải lại trang.</center>";
                                setTimeout(function () {
                                    location.reload();
                                }, 1500);
                            }
                        }, 20000);
                        if (!window.setting) {
                            window.setting = {};
                        }
                        var extparam = "";
                        try {
                            window.localStorage.getItem;
                        } catch (e) {
                            ui.notif("Trang web không có quyền lưu trữ dữ liệu vào trình duyệt, có khả năng sẽ không hoạt động. (Nguyên nhân: Duyệt ẩn danh, chặn lưu trữ, ...)");
                        }
                        if (bookhost == "sangtac" || bookhost == "dich") {
                            extparam += g("maincontent").clientWidth;
                            if (window.rgbToInt) {
                                var fffontc = localStorage.getItem("fontcolor");
                                var ffbgc = localStorage.getItem("backgroundcolor");
                                if (fffontc)
                                    extparam += "^" + window.rgbToInt(fffontc);
                                else {
                                    extparam += "^" + "-16777216";
                                }
                                if (ffbgc)
                                    extparam += "^" + window.rgbToInt(ffbgc);
                                else {
                                    extparam += "^" + "-1383213";
                                }
                            }
                        }
                        document.oncopy = function () {
                            var txt = window.getSelection().toString();
                            if (txt.length > 1e3) {
                                ui.copy("Truyện được đăng tại " + location.href + "\n" + rdmzr(txt));
                                ajax("ajax=leaking&b=" + bookid + "&c=" + currentid);
                            }
                        }
                        if (window.isComic) {
                            ui.scriptmanager.load("https://comic.sangtacvietcdn.xyz/data/js/comic.js?r=40", function () {
                                comicRenderer.init(contentcontainer);
                                comicRenderer.load(bookhost, bookid, currentid);
                                updatenewlinkcomic(bookhost, bookid, currentid);
                            });
                            clearTimeout(timerout);
                        } else {
                            chapterfetcher.open('POST', '/index.php?bookid=' + bookid + '&h=' + bookhost + '&c=' + currentid + '&ngmar=readc&sajax=readchapter&sty=' + booksty + "&exts=" + extparam, true);
                            chapterfetcher.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                        }

                        chapterfetcher.onreadystatechange = function () {
                            if (chapterfetcher.readyState == 4 && chapterfetcher.status == 200) {
                                clearTimeout(timerout);
                                var x = {};
                                try {
                                    x = JSON.parse(chapterfetcher.responseText);
                                } catch (e) {
                                    try {
                                        x = JSON.parse(chapterfetcher.responseText.substring(chapterfetcher.responseText.indexOf("{\"")));
                                    } catch (e) {
                                        console.log(chapterfetcher.responseText);
                                        return
                                    }
                                }
                                try {
                                    if (x.code == "0") {
                                        g("breadcum").textContent = x.bookname + " / " + x.chaptername;
                                        g("booknameholder").textContent = x.bookname;
                                        g("bookchapnameholder").textContent = x.chaptername;
                                        if (bookhost == "trxs" || bookhost == "bxwxorg" || bookhost == "faloo" || bookhost == "biquge" || bookhost == "fanqie") {
                                            x.next = 0;
                                            x.prev = 0;
                                        }
                                        if (x.next < x.prev && bookhost != "qidian") {
                                            var tmpprev = x.prev;
                                            x.prev = x.next; x.next = tmpprev;
                                        }
                                        var setnav = function (x, aRetry) {
                                            try {
                                                g("navprevtop").setAttribute("href", `/truyen/${x.bookhost}/1/${x.bookid}/${x.prev}/`);
                                                g("navnexttop").setAttribute("href", `/truyen/${x.bookhost}/1/${x.bookid}/${x.next}/`);
                                                g("navprevbot").setAttribute("href", `/truyen/${x.bookhost}/1/${x.bookid}/${x.prev}/`);
                                                g("navnextbot").setAttribute("href", `/truyen/${x.bookhost}/1/${x.bookid}/${x.next}/`);
                                                g("navcentertop").setAttribute("href", `/truyen/${x.bookhost}/1/${x.bookid}/`);
                                                g("navcenterbot").setAttribute("href", `/truyen/${x.bookhost}/1/${x.bookid}/`);
                                                g("originbutton").setAttribute("onclick", "location.href='" + x.origin + "'");
                                                if (x.origin.length < 5) {
                                                    g("originbutton").style.display = "none";
                                                }
                                            } catch (e) {
                                                if (aRetry) {
                                                    setTimeout(function () {
                                                        setnav(x, false);
                                                    }, 1000);
                                                } else {
                                                    ajax("sajax=reportscripterror&data=SET NAV: " + e.stack + "&file=" + encodeURIComponent(location.href) + "&line=0:0", function () { });
                                                }
                                            }
                                        }
                                        setnav(x, true);
                                        if (x.next == 0 || x.next == "0" || x.prev == 0 || x.prev == "0") {
                                            updatenewlink(x.bookhost, x.bookid, currentid);
                                            //setTimeout(function(){

                                            //},1500);
                                        }
                                        document.title = x.chaptername + " - " + x.bookname + " - Sáng Tác Việt - sangtacviet.com";
                                        window.bookOwner = x.owner;
                                        //g("maincontent").innerHTML=x.data;
                                        //loadnodedata();
                                        //g("maincontent").innerHTML= preprocess(x.data);
                                        //g("maincontent").offsetHeight;
                                        try {
                                            if (window.updateTusach) {
                                                updateTusach();
                                            } else {
                                                setTimeout(function () {
                                                    updateTusach();
                                                }, 1000);
                                            }
                                        } catch (e1) {
                                            console.log(e1);
                                        }
                                        if (!window.contentcontainer) {
                                            window.contentcontainer = "maincontent";
                                        } else if (g(contentcontainer) == null) {
                                            window.contentcontainer = "maincontent";
                                        }
                                        if (chapterfetcher.getResponseHeader("X-ReqId")) {
                                            setContentAiTranslate(chapterfetcher.getResponseHeader("X-ReqId"));
                                        } else if (x.isComic) {
                                            loadComic(x.target);
                                        } else if (window.moveitoupper) {
                                            tmpctn.innerHTML = preprocess(x.data);
                                            moveitoupper(tmpctn.innerHTML);
                                        } else {
                                            g("maincontent").innerHTML = preprocess(x.data);
                                        }

                                        var nid = "cld-" + bookid + "-" + currentid;
                                        g(contentcontainer).id = nid;
                                        contentcontainer = nid;
                                        if (window.ttsUI && !chapterfetcher.getResponseHeader("X-ReqId")) {
                                            setTimeout(function () {
                                                ttsUI.onContentLoaded();
                                            }, 200);
                                        }
                                        if (window.handleDefaultName) {
                                            handleDefaultName(x.defaultname);
                                        }
                                        if (false) {
                                            setTimeout(function () {
                                                applyNodeList(); excute();

                                            }, 100);
                                        } else {
                                            if (window.applyNodeList) {
                                                if (!window.hanvietdic) {
                                                    ui.scriptmanager.load("/hanviet.js", function () {
                                                        applyNodeList();
                                                        window.handleDefaultName && handleDefaultName(x.defaultname);
                                                        excute();
                                                    });
                                                } else {
                                                    applyNodeList(); window.handleDefaultName && handleDefaultName(x.defaultname); excute();
                                                }
                                            } else {
                                                ui.scriptmanager.load("/qtOnline.js", function () {
                                                    applyNodeList(); window.handleDefaultName && handleDefaultName(x.defaultname); excute();
                                                });
                                            }
                                        }


                                        window.newchapid = x.next;
                                        //setTimeout(excute, 300);
                                        //setTimeout(excute, 2000);
                                        if (window.tse) tse.autoexcute = true;

                                        if (window.setting && window.setting.overread) {
                                            window.onscroll = overread;
                                        } else {
                                            if (window.setting && window.setting.prefetch)
                                                setTimeout(function () {
                                                    var lastscrolle = false;
                                                    window.onscroll = function () {
                                                        if (lastscrolle) return;
                                                        if (document.body.scrollTop > document.body.scrollHeight / 2) {
                                                            loadNextChapter(x.bookhost, x.bookid, x.next, null);
                                                        }
                                                        lastscrolle = true;
                                                        setTimeout(function () {
                                                            lastscrolle = false;
                                                        }, 500);
                                                    }
                                                }, 5000);
                                        }
                                        if (["qidian", "zongheng", "faloo", "biquge", "jjwxc", "69shu", "sfacg"].indexOf(x.bookhost) >= 0) {
                                            if (
                                                chapterfetcher.getResponseHeader("X-No-Reload") != "1" &&
                                                !chapterfetcher.getResponseHeader("X-ReqId")
                                            ) {
                                                setTimeout(function () {
                                                    if (q("#" + contentcontainer + " i").length < 150) {
                                                        if (g(contentcontainer).textContent.length < 150) {
                                                            var btn = document.createElement("button");
                                                            btn.setAttribute("class", "btn btn-secondary w-100");
                                                            btn.innerHTML = "Nội dung không đầy đủ?, nhấp để hệ thống tải lại.";
                                                            btn.onclick = function () {
                                                                gotox();
                                                            }
                                                            g(contentcontainer).appendChild(btn);
                                                        }
                                                    }
                                                }, 1000);
                                            }
                                        }
                                        if (x.bookhost == "faloo") {
                                            setTimeout(function () {
                                                var c = g(contentcontainer);
                                                if (!c.style.fontFamily) {
                                                    c.style.fontFamily = "stvarial";
                                                } else
                                                    if (c.style.fontFamily.match(/arial|tahoma|verdana/i)) {
                                                        var cf = c.style.fontFamily.match(/(arial|tahoma|verdana)/i)
                                                        c.style.fontFamily = "stv" + cf[0];
                                                    }
                                            }, 3000);
                                        } else {
                                            if (window.speaker) {
                                                if (speaker.autocontinue) {
                                                    speaker.readBook();
                                                }
                                            } else {
                                                ui.scriptmanager.load("/qtOnline.js", function () {
                                                    if (window.speaker) {
                                                        if (speaker.autocontinue) {
                                                            speaker.readBook();
                                                        }
                                                    }
                                                });
                                            }
                                        }
                                        q("br+br+br+br").forEach(function (e) {
                                            if (e.previousSibling
                                                && e.previousSibling.tagName == "BR"
                                                && e.previousSibling.previousSibling
                                                && e.previousSibling.previousSibling.tagName == "BR") {
                                                e.pE && e.pE().remove();
                                                e.remove();
                                            }
                                        });

                                    } else {
                                        handlingReadException(x);
                                    }
                                } catch (exc) {
                                    var msg = exc.toString() + "\n" + exc.stack;
                                    var url = location.href;
                                    ajax("sajax=reportscripterror&data=READ: " + encodeURIComponent(msg) + "&file=" + encodeURIComponent(url) + "&line=" + 0 + ":" + 0, function () { });
                                }
                            } else if (chapterfetcher.readyState == 4 && chapterfetcher.status >= 500) {
                                setTimeout(function () {
                                    location.reload();
                                }, 2000);
                            }
                        }

                        if (!window.isComic)
                            chapterfetcher.send("");


                        function updatenewlink(h, id, c, calb) {
                            ajaxUrl("/io/novel/updateOldLink", "host=" + h + "&bookid=" + id + "&chapterid=" + c, function (res) {
                                res = res.split("-");
                                if (res[1] != "0" && res[1]) {
                                    g("navnexttop").setAttribute("href", `/truyen/${h}/1/${id}/${res[1]}/`);
                                    g("navnextbot").setAttribute("href", `/truyen/${h}/1/${id}/${res[1]}/`);
                                    if (window.setting && window.setting.allowunitymode) {
                                        window.newchapid = res[1];
                                    }
                                }
                                if (res[0] != "0" && res[0]) {
                                    g("navprevtop").setAttribute("href", `/truyen/${h}/1/${id}/${res[0]}/`);
                                    g("navprevbot").setAttribute("href", `/truyen/${h}/1/${id}/${res[0]}/`);
                                }
                                window.newlinkupdated = true;
                                if (calb != null) {
                                    calb();
                                }
                            });

                        }
                        function handleDefaultName(name) {
                            if (name) {
                                window.bookHaveDefaultName = true;
                                window.bookDefaultName = name;
                            }
                        }
                        function handlingReadException(x) {
                            if (x.code + 1 - 1 == x.code) {
                                x.code = x.code.toString();
                            }
                            if (x.code == "12") {
                                alert((x.err || x.info) + "\n" + location.href);
                                setTimeout(window.openloginmodal, 200);
                                if (!window.openloginmodal) {
                                    ajax("sajax=reportscripterror&data=NO LOGIN SESSION&file=" + encodeURIComponent(location.href) + "&line=0:0", function () { });
                                }
                            } else
                                if (x.code == "13") {
                                    setTimeout(window.openloginmodal, 200);
                                } else
                                    if (x.code == "15") {
                                        location = x.url;
                                    } else
                                        if (x.code == "18") {
                                            window.open(x.url);
                                        } else
                                            if (x.code == "19") {
                                                alert((x.err || x.info) + "\n" + location.href);
                                                window.open(x.url);
                                            } else
                                                if (x.code == "7") {
                                                    try {
                                                        window.localStorage.getItem;
                                                        document.cookie = "cookieenabled=true";
                                                        if (document.cookie.indexOf("cookieenabled=true") < 0) {
                                                            throw "";
                                                        }
                                                    } catch (e) {
                                                        ui.notif("Trang web không có quyền lưu trữ dữ liệu vào trình duyệt, có khả năng sẽ không hoạt động. (Nguyên nhân: Duyệt ẩn danh, chặn lưu trữ, ...)");
                                                        if (location.protocol !== 'https:' && !/\d\./.test(location.href)) {
                                                            location.replace(`https:${location.href.substring(location.protocol.length)}`);
                                                        }
                                                        return;
                                                    }
                                                    if (x.time) {
                                                        setTimeout(function () { location.reload() }, x.time);
                                                    } else
                                                        location.reload();
                                                } else
                                                    if (x.code == "21") {
                                                        //openCaptcha();
                                                        ui.captcha.open("read", "cloudflare");
                                                    } else
                                                        if (x.code == "101") {
                                                            loadComic(x.url);
                                                        } else
                                                            if (x.code == "5") { alert(x.info || x.err); }
                                                            else {
                                                                if (g("originbutton")) { g("originbutton").setAttribute("onclick", "location.href='" + (x.origin || "#") + "'"); }
                                                                alert((x.err || x.info) + "\n" + location.href);
                                                                if ((x.err || x.info) + "" == "undefined" || x.code != '1') {
                                                                    ajax("sajax=reportscripterror&data=" + encodeURIComponent(JSON.stringify(x)), function () { });
                                                                }
                                                                g(contentcontainer).innerHTML = (x.err || x.info);
                                                            }
                        }
                        function updatenewlinkcomic(h, id, c, calb) {
                            //return;
                            ajax("sajax=updatenewlinkcomic&host=" + h + "&bookid=" + id + "&chap=" + c, function (res) {
                                res = res.split("-");
                                if (res[1] != "0") {
                                    g("navnexttop").setAttribute("href", `/truyen/${h}/1/${id}/${res[1]}/`);
                                    g("navnextbot").setAttribute("href", `/truyen/${h}/1/${id}/${res[1]}/`);
                                    if (window.setting && window.setting.allowunitymode) {
                                        window.newchapid = res[1];
                                    }
                                }
                                if (res[0] != "0") {
                                    g("navprevtop").setAttribute("href", `/truyen/${h}/1/${id}/${res[0]}/`);
                                    g("navprevbot").setAttribute("href", `/truyen/${h}/1/${id}/${res[0]}/`);
                                }
                                window.newlinkupdated = true;
                                g("bookchapnameholder").textContent = "[" + res[3] + "]" + res[2];
                                g("booknameholder").textContent = res[4];
                                updateTusach();
                                document.title = `${res[4]} Chap ${res[3]}: ${res[2]} - Đọc truyện tranh dịch tự động tại sangtacviet.com`;
                                if (calb != null) {
                                    calb();
                                }
                            });

                        }
                        function gotox() {
                            chapterfetcher.open('POST', '/index.php?bookid=' + bookid + '&h=' + bookhost + '&c=' + currentid + '&ngmar=readc&sajax=readchapter&sty=' + booksty
                                , true);
                            chapterfetcher.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                            g(contentcontainer).innerHTML = '<br><center><span class="spinner-border"></span><br>Đang tải nội dung chương...</center><br>';
                            chapterfetcher.send("rescan=true&k=");
                        }
                        var loadednext = false;
                        function loadNextChapter(host, id, chap) {
                            if (loadednext || chap == 0 || chap == "0") {
                                return;
                            }
                            loadednext = true;
                            ajax("sajax=readchapter&prefetch=true&bookid=" + id + '&h=' + host + '&c=' + chap + '&sty=1', function () { });
                        }
                        function decodeNumMask(e) { var t = "", n = e.split("-"); for (var r = 0; r < n.length; r++)t += String.fromCharCode(n[r]); return t }
                        function preprocess(str) {
                            //try{
                            //	str=str.replace(/<i h='(.*?)'t='(.*?)'>(.*?)<\/i>/g,function(match,g1,g2,g3){
                            //return "<i h='"+g1+"'t='"+g2+"'v='"+g3+"'>"+g3.split("/")[0]+"</i>";
                            //});
                            //}catch(xxx){}
                            if (!str) {
                                return "";
                            }
                            if (str.indexOf("chat-") >= 0) {
                                return str;
                            }
                            var isFrn = getCookie("foreignlang") != "vi";
                            if (bookhost == "sangtac" || (bookhost == "dich" && !isFrn)) {
                                str = str.replace(/<[^i\/]/g, "&gt;").replace(/[\n]+/g, "<br><br>");
                                //str=str.replace(/\[img src=/g,"<img src=");
                                str = str.replace(/ ([,\.!\?:”]+)/g, "$1");
                                if (bookhost == "sangtac") {
                                    str = str.replace(/\[\[([^[\]]*)\]\]/g, function (match, encoded) {
                                        var decoded = decodeNumMask(encoded);
                                        return '<img src="' + decoded + '">';
                                    });
                                    return str;
                                }
                            }
                            if (["faloo", "dich", "sangtac"].indexOf(bookhost) > -1) {
                                var css = document.createElement("style");
                                css.innerHTML = ".contentbox{word-break: keep-all !important;}";
                                document.body.appendChild(css);
                            }
                            str = str.replace(/<\/p>\r\n<p>/g, "<br><br>");
                            if (location.href.indexOf("ciweimao") > 0) {
                                str = str.replace(/<span>.*?<\/span>/g, "");
                                str = str.replace(/<img src="(.*?)".*?>/g, "<img referrerpolicy=\"no-referrer\" src=\"$1\">");
                            }
                            if (getCookie("foreignlang") && isFrn) {
                                str = str.replace(/<br>/g, "<br><br>");
                                str = str.replace(/\n+/g, "<br><br>");
                                str = str.replace(/<br><br>(<br>)+/g, "<br><br>");
                                if (/<br>[^\<]{500,}/.test(str)) {
                                    str = str.replace(/<br>[^\<]{500,}/g, function (m) {
                                        return m.replace(/([\.!]+)/g, "$1<br><br>");
                                    });
                                }
                                return str;
                            }
                            if (getCookie("transmode") && getCookie("transmode") == "tfms") {
                                str = str.replace(/<br>/g, "<br><br>");
                                str = str.replace(/\n+/g, "<br><br>");
                                str = str.replace(/<br><br>(<br>)+/g, "<br><br>");
                                return str;
                            }
                            if (getCookie("transmode") && getCookie("transmode") == "tfms2") {
                                str = str.replace(/\n/g, "<br>");
                                return str;
                            }
                            if (bookhost == "fanqie") {
                                str = str.replace(/<\/?article>/g, "");
                                str = str.replace(/_i_/g, "~");
                            }

                            str = str.replace(/đạo ?<\/i>:/g, "nói</i>:");
                            str = str.replace(/&nbsp;&nbsp;&nbsp;&nbsp;/g, "<br>");
                            str = str.replace(/\n/g, "<br>");
                            str = str.replace(/(\w) \./g, "$1.");
                            str = str.replace(/((\w\.{1}[ \t])|(\w[!?]+(”|】)?))/g, "$1<br><br>");
                            str = str.replace(/<br( ?\/)?>/ig, "<br><br>");
                            str = str.replace(/(<br>(|\n|\t|\r| )*)+/g, "<br><br>");
                            str = str.replace(/([\w>])“/g, "$1 “");
                            str = str.replace(/(\w)<\/i><br>“/g, "$1</i>.<br>");
                            str = str.replace(/ ”/g, "”");
                            if (location.href.indexOf("uukanshu") > 0) {
                                str = str.replace(/<div class="ad_content">.*?<\/div>/g, "");
                            }
                            if (location.href.indexOf("aikanshu") > 0) {
                                str = str.replace(/<img.*?src="\/novel\/images.*?>/g, "");
                            }

                            str = str.replace(/<a href=.*?<\/a>/g, "");
                            str = str.replace(/<br><br>([\)” 】!?]+)(<br>|$)/g, "$1$2");
                            str = str.replace(/ ([,’]) /g, "$1 ");
                            str = str.replace(/ ‘ /g, " ‘");
                            str = str.replace("<a&nbsp;href=\"http:", "");
                            if (bookhost == "faloo") {
                                str = str.replace(/<br>/g, "<br>\n");
                                str = str.replace(/<br>\n([^“][^\n“]*?)”<br>/g, "<br>“$1”<br>");
                                str = str.replace(/<br>\n/g, "<br>");
                            }
                            str = str.replace(/<\/p><br><br><p>/g, "<br><br>");
                            str = str.replace(/ ([,\.!\?”]+)/g, "$1");
                            if (bookhost == 'fanqie') {
                                str = str.replace(/src=".*?"/g, function (m) { return m.replace(/<br>/g, ""); });
                            }
                            return str.replace("\ufffe", "");
                        }
                        try {
                            analyzer.tocollect = ["其他"];
                            //analyzer.lookforcollect();
                        } catch (e) { }
                    </script>

                </div>
            </div>
            <script type="text/javascript">
                var bg = localStorage.getItem("backgroundcolor");
                if (bg != null) {
                    try {
                        g(contentcontainer).style.backgroundColor = bg;
                        g("full").style.backgroundColor = (bg.split(")")[0] + ", 0.7)").replace("rgb", "rgba");
                        if (getCookie("theme") == "light") {
                            g("tm-bot-nav").className += " reader-add";
                            g("mainbar").className += " reader-add";
                            g("commentportion").className += " reader-add";
                            g("tm-credit-section").className += " reader-add";
                            g("full").appendChild(g("tm-credit-section"));
                            g("id").className += " reader-add";
                        }
                    } catch (e) { }
                }

            </script>
            <div class="tm-reader-top-nav" style="background: #eeeeee;font-size: 16px;padding: 6px 0;font-weight: 500">
                <div class="container flex">
                    <a onclick="blinkloadnextchap(true)" id="navprevbot" href="" style="flex:1;padding: 10px 0"><i
                            class="fas fa-chevron-left"></i> Chương trước</a>
                    <a id="navcenterbot" href="/truyen/ciweimao/1/100464209/" style="padding: 10px 8px;"> Mục lục </a>
                    <a onclick="blinkloadnextchap()" id="navnextbot" href=""
                        style="flex:1;text-align: right;padding: 10px 0">Chương sau <i
                            class="fas fa-chevron-right"></i></a>
                </div>
            </div><br>
            <div style="width: 100%;" class="container">
                <button id="originbutton" class="btn bg-light mb-1"><i class="fas fa-external-link-alt"></i> Xem trang
                    gốc</button>
                <button id="translatoroptionbutton" onclick="showNovelTranslatorOption()" class="btn bg-light mb-1"><i
                        style="font-size: 16px" class="fas fa-cog"></i> Ngôn ngữ/Dịch thuật</button>
            </div>
            <br>
            <div class="container">
                <script>
                    var thispage = 'content';
                    function reportbrokenchapter() {
                        if (confirm('Xác nhận chương này bị lỗi ( Chống trộm, nhầm nội dung, scan sai... )?, hệ thống sẽ xóa cache để bạn có thể tải lại.')) {
                            ajax("ajax=clearchaptercache&host=" + bookhost + "&bookid=" + bookid + "&c=" + currentid, function (d) {
                                if (d == "success") {
                                    g("tm-btn-rescan").click();
                                } else {
                                    alert(d);
                                }
                            });
                        }
                    }
                    function gonextchapter() {
                        var hr = g("navnextbot").href;
                        if (window.newlinkupdated || hr.match(/\d+\/$/)[0] != "0/") {
                            location = g("navnextbot").href;
                        } else {
                            updatenewlink(bookhost, bookid, currentid, function () {
                                gonextchapter();
                            });
                            event.preventDefault();
                        }
                    }
                    function blinkloadnextchap(isrev) {
                        var href = isrev ? g("navprevbot").href : g("navnextbot").href;
                        if (href && (new RegExp("(/0/|/" + currentid + "/)$")).test(href) && !window.newlinkupdated) {
                            event.preventDefault();
                            return false;
                        }
                        if (window.setting.enableswiftload) {
                            event.preventDefault();
                            ui.unity.loadnextchapter = function () { };
                            ui.swiftload(href, "naviga", function () {
                                contentcontainer = "maincontent";
                                loadConfig();
                                defineSys();
                            });
                        }

                    }


                    function updateTusach() {
                        var s = localStorage;
                        var ss = s.getItem("tusach");
                        var th = "";
                        var bookchap = currentid;
                        var sc = 0;
                        var na = g("booknameholder").innerHTML;
                        var cn = g("bookchapnameholder").innerHTML;
                        var haveupdate = false;
                        if (ss == null || ss == "") {
                            var o = { host: bookhost, thumb: th, name: na, chapter: sc, id: bookid, current: currentid + "-,-" + cn };
                            s.setItem("tusach", JSON.stringify(o));
                        } else {
                            var sss = ss.split("~/~");
                            var arr = [];
                            var flag = false;
                            sss.forEach(function (e) {
                                if (e != "") {
                                    try {
                                        var f = JSON.parse(e);
                                        if (f.host == bookhost && f.id == bookid) {
                                            if (f.current != bookchap + "-,-" + cn) {
                                                haveupdate = true;
                                            }
                                            f.current = bookchap + "-,-" + cn;
                                            arr.unshift(JSON.stringify(f));
                                            flag = true;
                                        }
                                        else {
                                            arr.push(e);
                                        }
                                    }
                                    catch (ukne) {
                                        var f = e.split("~.~");
                                        var o = { host: f[0], thumb: "/default.png", name: f[4], chapter: "?", id: f[2], current: f[3] + "-,-Chưa rõ tên" };
                                        arr.push(JSON.stringify(o));
                                    }

                                }
                            });
                            if (!flag) {
                                var o = { host: bookhost, thumb: th, name: na, chapter: sc, id: bookid, current: bookchap + "-,-" + cn };
                                arr.unshift(JSON.stringify(o));
                            }
                            try {
                                s.setItem("tusach", arr.join("~/~"));
                            } catch (e) {
                                var msg = e.toString();
                                if (msg.toLowerCase().indexOf("quota") >= 0) {
                                    arr.splice(arr.length - 10, 10);
                                    try {
                                        s.setItem("tusach", arr.join("~/~"));
                                    } catch (e) {
                                        ui.notif("Dung lượng lưu trữ offline trên trình duyệt của bạn đã hết, đề nghị xóa bớt lịch sử đọc");
                                    }
                                }
                            }
                            if (haveupdate) {
                                var timeStamp = Math.floor(new Date().getTime() / 1000);
                                var expires = new Date();
                                expires.setDate(expires.getDate() + 24 * 14);
                                document.cookie = "hstamp=" + timeStamp + "; path=/; expires=" + expires.toUTCString();
                            }
                        }
                    }
                    function setContentAiTranslate(reqId) {
                        // content-type: event-stream
                        var endpoint = "/io/aitranslate2/passContext?reqId=";
                        var maxNameCount = 1000;
                        var passUrl = endpoint + reqId;
                        var names = [];
                        var targetLang = getCookie("foreignlang") || "vi";
                        loadNameData();
                        if (window.namew) {
                            if (targetLang == "vi") {
                                var n = window.namew.value.split("\n");
                                for (var i = 0; i < n.length; i++) {
                                    if (n[i].length > 0 && n[i][0] == "$") {
                                        names.push(n[i].replace(/[\$\|]/g, ""));
                                    }
                                    if (names.length >= maxNameCount) {
                                        break;
                                    }
                                }
                            } else {
                                var n = window.namew.value.split("\n");
                                for (var i = 0; i < n.length; i++) {
                                    if (n[i].length > 0 && n[i][0] == "$") {
                                        var parts = n[i].split("=");
                                        if (parts[1] && parts[1].match(/[a-z0-9A-Z ']+/)) {
                                            // should be english
                                            names.push(n[i].replace(/[\$\|]/g, ""));
                                        }
                                    }
                                    if (names.length >= 100) {
                                        break;
                                    }
                                }
                            }
                        }
                        var xhr = new POSTEventSource(passUrl, {
                            headers: {
                                "Content-Type": "application/x-www-form-urlencoded"
                            },
                            data: "names=" + encodeURIComponent(names.join("\n"))
                        });
                        var isFirstMessage = true;
                        var currentPara = null;
                        var textMemory = [];
                        var isTextStructured = false;
                        var isThinking = false;
                        var replaceQuotesIfEven = function (str) {
                            var quoteCount = (str.split('"').length - 1);
                            if (quoteCount % 2 !== 0 || quoteCount === 0) {
                                return str;
                            }
                            var isOpening = true;
                            var replacedStr = str.replace(/"/g, () => {
                                if (isOpening) {
                                    isOpening = false;
                                    return '“';
                                } else {
                                    isOpening = true;
                                    return '”';
                                }
                            });
                            return replacedStr;
                        }
                        var createPara = function (initText = "") {
                            if (currentPara) {
                                currentPara.close();
                            }
                            var p = document.createElement("div");
                            g(contentcontainer).appendChild(p);
                            p.close = function () {
                                if (this.textContent.trim().length == 0) {
                                    this.remove();
                                    return;
                                }
                                var br = document.createElement("br");
                                this.appendChild(br);
                                br = document.createElement("br");
                                this.appendChild(br);
                                if (textMemory.length > 0 && !this.isHaveBackedText && !this.isThinkTokens) {
                                    if (isTextStructured) {
                                        this.isHaveBackedText = true;
                                        this.backedText = textMemory.shift();
                                    } else if (this.textContent.match(/\w/)) {
                                        this.isHaveBackedText = true;
                                        this.backedText = textMemory.shift();
                                        if (this.backedText.length < 2 && this.textContent.length > 10) {
                                            this.backedText = textMemory.shift();
                                        }
                                    }
                                }
                                if (!isThinking && !this.isThinkTokens) {
                                    if (window.ttsUI) {
                                        try {
                                            if (!this.previousElementSibling) {
                                                ttsUI.onContentLoaded();
                                            }
                                            ttsUI.player.watch(false);
                                        } catch (e) {
                                            console.log("TTS UI error: ", e);
                                        }
                                    }
                                }
                            }
                            p.addText = function (t) {
                                var tmp = this.textContent + t;
                                if (tmp.indexOf("names>") >= 0) {
                                    tmp = tmp.replace(/<\/?names>/g, "");
                                }
                                if (tmp.indexOf("*") >= 0) {
                                    var numOfStars = tmp.match(/\*/g).length;
                                    if (numOfStars % 2 == 0) {
                                        tmp = tmp.replace(/\*/g, ""); // trim markdown bold and italic
                                    }
                                }
                                if (tmp.indexOf('"') >= 0) {
                                    tmp = replaceQuotesIfEven(tmp);
                                }
                                if (tmp.indexOf("<think>") >= 0) {
                                    isThinking = true;
                                    g(contentcontainer).innerHTML = '<br><center><span class="spinner-border"></span><br>Mô hình AI bạn đã chọn đang suy nghĩ, vui lòng chờ...</center><br>';
                                }
                                if (isThinking) {
                                    this.isThinkTokens = true;
                                    this.remove();
                                }
                                if (tmp.indexOf("</think>") >= 0) {
                                    isThinking = false;
                                    g(contentcontainer).innerHTML = '';
                                }
                                if (tmp.match(/[^ \.\/\:\d]\d/)) {
                                    tmp = tmp.replace(/([^ \.\/\:\d])(\d)/g, "$1 $2");
                                }
                                this.textContent = tmp;
                            }
                            currentPara = p;
                            currentPara.addText(initText);
                            p.style.userSelect = "none";
                            if (targetLang == "vi") {
                                p.addEventListener("dblclick", function () {
                                    if (this.backedText)
                                        showSimpleEditnameSelector(this.backedText);
                                });
                            }
                        };
                        xhr.onopen = function (event) {
                            console.log("Connected to server");
                        };
                        xhr.onmessage = function (event) {
                            var evData = event.data;
                            if (evData == "[DONE]") {
                                xhr.close();
                                if (currentPara) {
                                    currentPara.close();
                                }
                                if (window.ttsUI) {
                                    try {
                                        ttsUI.player.notifyDocumentComplete();
                                    } catch (e) { }
                                }
                                return;
                            }
                            if (isFirstMessage) {
                                isFirstMessage = false;
                                g(contentcontainer).innerHTML = "";
                            }
                            var data = JSON.parse(event.data);
                            if (data.error) {
                                var msg = data.error;
                                var formatted = JSON.stringify(data, null, 2);
                                console.log("Error: " + msg + "\n" + formatted);
                                //if(isFirstMessage){
                                g(contentcontainer).innerHTML += `<br><br><center>Đã xảy ra lỗi khi dịch AI, hãy kiểm tra kỹ thông tin cấu hình api dịch <a href="javascript:openLlmConfig();">Kiểm tra</a>.</center><br>Chi tiết lỗi: <pre style="white-space: pre-wrap; word-break: break-all">${formatted}</pre>`;
                                //}
                            }
                            if (data.choices && data.choices.length > 0) {
                                var c0 = data.choices[0];
                                if (!c0.delta && c0.finish_reason) {
                                    createPara(`Mô hình AI không thể dịch nội dung do: <b>${c0.finish_reason}</b>. Vui lòng kiểm tra nội dung chương truyện, prompt đang sử dụng... hoặc đổi sang mô hình ít censor hơn.`);
                                }
                                var content = data.choices[0].delta.content;
                                if (content) {
                                    if (content.indexOf("\n") >= 0) {
                                        content = content.replace(/\n+/g, "\n");
                                        var paras = content.split("\n");
                                        if (currentPara) {
                                            currentPara.addText(paras[0]);
                                        } else {
                                            createPara(paras[0]);
                                        }
                                        for (var i = 1; i < paras.length; i++) {
                                            var t = paras[i];
                                            createPara(t);
                                        }
                                        return;
                                    }
                                    if (currentPara) {
                                        currentPara.addText(content);
                                    } else {
                                        createPara(content);
                                    }
                                }
                            }
                            if (data.sentences) {
                                textMemory = data.sentences;
                                isTextStructured = data.structured;
                            }
                        };
                        xhr.onerror = function (event) {
                            console.log("Error: " + xhr.xhr.status);
                            if (xhr.xhr.status == 502) {
                                console.log("Continue request..");
                                return setContentAiTranslate(reqId);
                            }
                            var resp = xhr.xhr.responseText;
                            var errMsg = "";
                            try {
                                var json = JSON.parse(resp);
                                if (json) {
                                    errMsg = JSON.stringify(json, null, 2);
                                }
                            } catch (e) {
                                errMsg = resp;
                            }
                            xhr.close(); // prevent reconnect
                            if (!currentPara) {
                                g(contentcontainer).innerHTML = `<br><br><center>Đã xảy ra lỗi khi dịch AI, hãy kiểm tra kỹ thông tin cấu hình api dịch <a href="javascript:openLlmConfig();">Kiểm tra</a>.</center><br>`;
                                if (errMsg.length > 0) {
                                    g(contentcontainer).innerHTML += `Chi tiết lỗi: <pre style="white-space: pre-wrap; word-break: break-all">${errMsg}</pre>`;
                                }
                                if (window.ttsUI) {
                                    try {
                                        ttsUI.player.unWatch();
                                    } catch (e) { }
                                }
                            }
                            var preloader = g(contentcontainer).querySelector(".spinner-border");
                            if (preloader) {
                                preloader.parentElement.remove();
                            }
                        };
                    }
                    function openLlmConfig() {
                        if (!window.modalLLMConfig) {
                            ui.scriptmanager.load("/stv.llmconfig.js", function () {
                                modalLLMConfig();
                            }, true);
                        } else {
                            modalLLMConfig();
                        }
                    }
                </script>
                <div id="boxfather">
                    <div id="nsbox" class="bg-info" contenteditable="false"
                        style="display:none;font-size: 16px;font-family: Arial" onkeydown="event.stopPropagation();"
                        onclick="event.stopPropagation();">
                        <style type="text/css">
                            button {
                                padding: 0;
                            }
                        </style>
                        <div class="row" style="flex-wrap: nowrap;">
                            <button type="button"
                                style="position: absolute;left: auto;top:0;right: 100%;width: 20%;height: 40px;"
                                class="btn btn-danger col" onclick="hideNb(this);"><i
                                    class="fas fa-times-circle"></i></button>
                            <button type="button" class="btn btn-info" onclick="expandLeft(this);"><i
                                    class="fas fa-chevron-circle-left"></i>Mở rộng</button>
                            <button type="button" class="btn btn-info" onclick="expandRight(this);">Mở rộng<i
                                    class="fas fa-chevron-circle-right"></i></button>
                            <button type="button" class="btn btn-danger col" onclick="hideNb(this);"><i
                                    class="fas fa-times-circle"></i></button>
                        </div>
                        <div class="row" style="display: none;">
                            <span
                                style="display:inline-block;width:30px;color:white;font-size:12px;padding:6px;background:green;">VP</span>
                            <input class="col" style="padding:0;font-size: 12px;" id="vuc"
                                placeholder=" Vietphrase viết hoa">
                            <button class="btn btn-info" onclick="applyNs('vuc')" type="button"><i
                                    class="far fa-check-circle"></i></button>
                            <button type="button" class="btn btn-info" onclick="applyAndSaveNs('vuc')"><i
                                    class="far fa-save"></i></button>
                        </div>
                        <div class="row">
                            <span
                                style="display:inline-block;width:30px;color:white;font-size:12px;padding:6px;background:green;">hv</span>
                            <input class="col" style="padding:0;font-size: 12px;" id="hv" placeholder=" Hán Việt">
                            <button onclick="applyNs('hv')" class="btn btn-info" type="button"><i
                                    class="far fa-check-circle"></i></button>
                            <button type="button" class="btn btn-info" onclick="applyAndSaveNs('hv')"><i
                                    class="far fa-save"></i></button>
                        </div>
                        <div class="row">
                            <span
                                style="display:inline-block;width:30px;color:white;font-size:12px;padding:6px;background:green;">HV</span>
                            <input class="col" style="padding:0;font-size: 12px;" id="huc"
                                placeholder=" Hán Việt viết hoa">
                            <button onclick="applyNs('huc')" class="btn btn-info" type="button"><i
                                    class="far fa-check-circle"></i></button>
                            <button type="button" class="btn btn-info" onclick="applyAndSaveNs('huc')"><i
                                    class="far fa-save"></i></button>
                        </div>
                        <div class="row">
                            <span
                                style="display:inline-block;width:30px;color:white;font-size:12px;padding:6px;background:green;">zw</span>
                            <input class="col" style="padding:0;font-size: 12px;" onkeyup="instrans(this)" id="zw"
                                placeholder="Tiếng Trung">
                            <button onclick="googletrans('zw')" class="btn btn-info" type="button"><i
                                    class="fas fa-language"></i></button>
                            <button type="button" class="btn btn-info" onclick="copychinese()"><i
                                    class="far fa-copy"></i></button>
                            <button onclick="googlesearch('zw')" class="btn btn-info" type="button"><i
                                    class="fas fa-search"></i></button>
                            <script>

                            </script>
                        </div>
                        <div class="row">
                            <span
                                style="display:inline-block;width:30px;color:white;font-size:12px;padding:6px;background:green;">Tr</span>
                            <input class="col" style="padding:0;font-size: 12px;font-family:nunito" id="instrans"
                                placeholder="Dịch trực tiếp">
                            <button onclick="openmodvp()" style="font-size: 12px;width: 82px;" class="btn btn-info"
                                type="button"><i class="far fa-edit"></i> Sửa</button>
                        </div>
                        <div class="row">
                            <span
                                style="display:inline-block;width:30px;color:white;font-size:12px;padding:6px;background:green;">tc</span>
                            <input class="col" style="padding:0;font-size: 12px;" id="op"
                                placeholder=" cụm từ tùy chọn">
                            <button onclick="applyNs('op')" class="btn btn-info" type="button"><i
                                    class="far fa-check-circle"></i></button>
                            <button class="btn btn-info" type="button" onclick="applyAndSaveNs('op')"><i
                                    class="far fa-save"></i></button>
                        </div>
                        <div class="row" style="flex-wrap: nowrap;">
                            <button onclick="showNS()" style="padding: 4px;" class="btn btn-info" type="button"><i
                                    class="fas fa-cog"></i> Quản lý </button>
                            <button class="btn btn-info" style="padding: 12px;" type="button" onclick="excute()"><i
                                    class="fas fa-play"></i></button>
                            <button class="btn btn-info" style="padding: 4px;" type="button" onclick="showAddName()"
                                data-toggle="modal" data-target="#addnamebox"><i class="fas fa-plus"></i> Thêm
                                name</button>

                        </div>

                    </div>
                    <div class="modal" style="font-size:12px;" id="addnamebox" onkeydown="event.stopPropagation()"
                        onclick="$(this).fadeOut();">
                        <style type="text/css">
                            .modal-body button {
                                padding: 4px;
                            }

                            .select-editable {
                                clear: both;
                                position: relative;
                                background-color: white;
                                border: solid grey 1px;
                                width: 100%;
                                height: 27px;
                            }

                            .select-editable select {
                                position: absolute;
                                top: 0px;
                                left: 0px;
                                font-size: 17px;
                                border: none;
                                width: 100%;
                                margin: 0;
                                background: #f5f5f5;
                            }

                            .select-editable input {
                                position: absolute;
                                top: 0px;
                                left: 0px;
                                width: 90%;
                                padding: 1px;
                                font-size: 15px;
                                border: none;
                            }

                            .select-editable select:focus,
                            .select-editable input:focus {
                                outline: none;
                            }
                        </style>
                        <div class="modal-dialog modal-sm modal-dialog-centered"
                            style="position: fixed;bottom: 10;left: 50%; transform: translate(-50%,0);width: 90%;max-width: 360px;"
                            onclick="event.stopPropagation();">
                            <div class="modal-content">
                                <script type="text/javascript">
                                    if (!isMobile) {
                                        var w = g("addnamebox").children[0];
                                        w.style.top = '10';
                                        w.style.bottom = 'auto';
                                    }

                                </script>
                                <div class="modal-header">
                                    <h6 class="modal-title">Thêm name/Chỉnh name</h6>
                                    <button type="button" class="close" data-dismiss="modal"
                                        onclick="$('#addnamebox').hide();">&times;</button>
                                </div>
                                <div class="modal-body">
                                    Tiếng Trung:<br>
                                    <input type="text" style="width: 100%" id="addnameboxip1"
                                        onkeyup="instrans2(this,false);" placeholder=" Tiếng trung">
                                    <br>
                                    Hán Việt:<br>
                                    <input type="text" style="width: 100%" id="addnameboxip3" placeholder=" Hán việt">
                                    <div style="display: flex;"><button type="button"
                                            onclick="addSuperName('hv','z')">Dùng</button>
                                        <button type="button" onclick="addSuperName('hv','f')">Hoa chữ đầu</button>
                                        <button type="button" onclick="addSuperName('hv','s')">Hoa 2 chữ đầu</button>
                                        <button type="button" onclick="addSuperName('hv','l')">Thường Chữ cuối</button>
                                        <button type="button" onclick="addSuperName('hv','a')">Hoa Toàn Bộ</button>
                                    </div>
                                    Tiếng Anh:<br>
                                    <input type="text" style="width: 100%" id="addnameboxip4"
                                        placeholder=" Tiếng Anh"><br>
                                    <button type="button" style="float: right;"
                                        onclick="addSuperName('el')">Dùng</button><br>
                                    Vietphrase:
                                    <div class="select-editable">
                                        <select onchange="this.nextElementSibling.value=this.value">
                                        </select>
                                        <input type="text" id="addnameboxip2" placeholder=" Vietphrase v.v.."
                                            name="format" value="" />
                                    </div>
                                    <button type="button" style="float: right;"
                                        onclick="addSuperName('vp')">Dùng</button>
                                    Name trong kho:<br>
                                    <div class="select-editable">
                                        <select onchange="this.nextElementSibling.value=this.value">
                                        </select>
                                        <input type="text" id="addnameboxip5" placeholder=" Name trong kho v.v.."
                                            name="format" value="" />
                                    </div>
                                    <button type="button" onclick="deleteName()">Xóa name</button>
                                    <button type="button" style="float: right;"
                                        onclick="addSuperName('kn')">Dùng</button>
                                </div>
                                <div id="booknamemanager" style="padding: 0 15px;" hidden class="bg-light">
                                    <span class="btn" onclick="this.nextElementSibling.click()">Lưu vào truyện </span>
                                    <input type="checkbox"
                                        onchange="store.setItem('issavetobook',this.checked?'true':'false')"
                                        id="issavetobook"
                                        style="float: right;transform: scale(2);-webkit-appearance: checkbox;margin: 12px 8px 0 0;">
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-info" onclick="addSuperName('el')">Thêm Name
                                        Anh</button>
                                    <button type="button" class="btn btn-info" onclick="addSuperName('hv','a')">Thêm Hán
                                        Việt</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="modal" style="font-size:12px;" id="modifyvpbox" onkeydown="event.stopPropagation()"
                        onclick="$(this).fadeOut();">
                        <div class="modal-dialog modal-sm modal-dialog-centered"
                            style="position: fixed;bottom: 10;left: 50%; transform: translate(-50%,0);width: 90%;max-width: 360px;"
                            onclick="event.stopPropagation();">
                            <div class="modal-content">
                                <script type="text/javascript">
                                    if (!isMobile) {
                                        var w = g("modifyvpbox").children[0];
                                        w.style.top = '10';
                                        w.style.bottom = 'auto';
                                    }

                                </script>
                                <div class="modal-header">
                                    <h6 class="modal-title">Chỉnh Vietphrase</h6>
                                    <button type="button" class="close" data-dismiss="modal"
                                        onclick="$('#modifyvpbox').hide();">&times;</button>
                                </div>
                                <div class="modal-body">
                                    Tiếng Trung:<br>
                                    <input type="text" style="width: 100%" id="modifyvpboxip1"
                                        onkeyup="instrans3(this);" placeholder=" Tiếng trung">
                                    <br>
                                    Hán Việt:<br>
                                    <input type="text" style="width: 100%" id="modifyvpboxip2" disabled
                                        placeholder=" Hán việt">
                                    <button type="button" style="float: right;" onclick="movehantomean()">Chuyển
                                        xuống</button>
                                    <br>
                                    Vietphrase:<br>
                                    <input type="text" style="width: 100%" id="modifyvpboxip3"
                                        placeholder=" Vietphrase"><br>
                                    <button type="button" onclick="movemeaning()">Nghĩa &lt;</button>
                                    <button type="button" style="float: right;"
                                        onclick="g('modifyvpboxip3').value='';">&nbsp;X&nbsp;</button>
                                    <button type="button" style="float: right;" onclick="openselectvp();">&nbsp;Ghép
                                        từ&nbsp;</button>
                                    <button type="button" style="float: right;" onclick="removeoddvp();">&nbsp;Giữ nghĩa
                                        1&nbsp;</button>
                                </div>
                                <div class="modal-footer">
                                    <button type="button" class="btn btn-info" onclick="delvp()">Xóa vp</button>
                                    <button type="button" class="btn btn-info" onclick="modvp()">Xác nhận</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="modal fade" id="cModal">
                    <div class="modal-dialog modal-sm modal-dialog-centered">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h6 id="cName" class="modal-title"></h6>
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                            </div>
                            <div class="modal-body">
                                Cấp vật phẩm: <b id="cLevel"></b><br>
                                <span id="addInfo"></span>
                                <div id="cInfo"></div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-danger" data-dismiss="modal"
                                    onclick="GrzAy2()">Ok</button>
                            </div>
                        </div>
                    </div>
                </div><button id="activeC" type="button" style="display:none;" data-toggle="modal"
                    data-target="#cModal">
                </button>
                <script>
                    var cType = 0;
                    var userId = 329882;
                    var userPerm = 'member';
                    function GrzAy() {
                        var params = "sajax=collect";
                        var http = new XMLHttpRequest();
                        var url = '/index.php?ngmar=collect';
                        http.open('POST', url, true);
                        http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                        http.onreadystatechange = function () {
                            if (http.readyState == 4 && http.status == 200) {
                                var x;
                                try {
                                    x = JSON.parse(http.responseText);
                                    g("cInfo").innerHTML = x.info;
                                    g("cName").innerHTML = x.name;
                                    g("cLevel").innerHTML = x.level;
                                    cType = x.type;
                                    if (cType == 3 || cType == 4) {
                                        g("cInfo").contentEditable = true;
                                        g("cInfo").style.border = "1px solid black";
                                        g("cName").contentEditable = true;
                                        g("cName").style.border = "1px solid black";
                                        g("addInfo").innerHTML = "Bạn vừa đạt được công pháp/vũ kỹ, hãy đặt tên và nội dung nào.<br>";
                                    }
                                    g("activeC").click();
                                }
                                catch (f) {
                                    alert(http.responseText);
                                }
                            }
                        }
                        http.send(params);
                    }
                    function GrzAy2() {
                        var params = "ajax=fcollect&c=114386813";
                        if (cType == 3 || cType == 4) {
                            var nname = g("cName").innerText;
                            if (nname.length > 80) {
                                return;
                                alert("Tên công pháp/vũ kỹ quá dài.");
                            }
                            params += "&newname=" + encodeURI(nname) + "&newinfo=" + encodeURI(g("cInfo").innerText);
                        }
                        var http = new XMLHttpRequest();
                        var url = '/index.php?ngmar=fcl';
                        http.open('POST', url, true);
                        http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                        http.onreadystatechange = function () {
                            if (http.readyState == 4 && http.status == 200) {
                                try {
                                    var x = JSON.parse(http.responseText);
                                    if (x.code == 1) {
                                        g("GrzAy").remove();
                                        ui.notif("Thành công");
                                    } else {
                                        g("GrzAy").remove();
                                        if (x.err.contains("không nhặt được gì")) {
                                            ui.alert("Thật đáng tiếc, kỳ ngộ đã không cánh mà bay, có duyên gặp lại ah.");
                                        } else
                                            ui.alert(x.err);
                                    }
                                }
                                catch (e) {
                                    try {
                                        g("GrzAy").remove();
                                    } catch (e2) { }
                                }
                            }
                        }
                        http.send(params);
                    }
                    function downtxt() {
                        ajax("ajax=downtxt&host=ciweimao&bookid=100464209&chapterid=114386813", function (down) {
                            if (down == "nomoney") {
                                return alert("Tài khoản không đủ thần thạch.");
                            }
                            if (down.substr(0, 5) == "error") {
                                return alert("Lỗi không xác định: " + down.substr(5, 6) + ".");
                            }
                            function download(filename, text) {
                                var element = document.createElement('a');
                                element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
                                element.setAttribute('download', filename);
                                element.style.display = 'none';
                                document.body.appendChild(element);
                                element.click();
                                document.body.removeChild(element);
                            }
                            download("100464209-114386813.txt", down);
                        })
                    }
                    function tryCollect(alr) {
                        if (q("[ontouchup]").length > 0) return;
                        var params = "ngmar=tcollect&sajax=trycollect";
                        var http = new XMLHttpRequest();
                        var url = '/index.php?ngmar=iscollectable';
                        var invoke = function () {
                            var wd = g(contentcontainer);
                            var node = wd.querySelectorAll("i");
                            if (node.length < 400) return;
                            var min = node.length / 3;
                            var max = node.length * (2 / 3);
                            var pos = Math.floor(Math.random() * (max - min) + min);
                            var btn = document.createElement("i");
                            btn.innerHTML = "Nhặt bảo";
                            btn.className = "btn btn-info";
                            btn.id = "GrzAy";
                            btn.addEventListener("mousemove", function () {
                                this.setAttribute("onmousedown", "GrzAy()");
                                new 0;
                            });
                            btn.setAttribute("ontouchup", "GrzAy()");
                            node[pos].parentNode.insertBefore(btn, node[pos]);
                        };
                        if (alr) {
                            return invoke();
                        }
                        http.open('POST', url, true);
                        http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                        http.onreadystatechange = function () {
                            if (http.readyState == 4 && http.status == 200) {
                                try {
                                    if (window.setting && window.setting.allowcollect === false) {
                                        return;
                                    }
                                    var x = JSON.parse(http.responseText);
                                    if (x.code == 1) {
                                        invoke();
                                    } else {
                                    }
                                }
                                catch (e) {
                                }
                            }
                        }
                        http.send(params);
                    }
                    setTimeout(function () {
                        tryCollect();
                    }, 15000);

                </script>


                <script src='/stv.tts.v2.min.js?v75'></script>
                <div class="row" id="commentportion" onkeydown="event.stopPropagation();"
                    style="background-color:white;overflow:hidden;padding:14px;font-size:24px;min-height:360px;color:black">

                    <div class="w-100">BÌNH LUẬN

                        <span id="livecomment" style="float:right;padding:0 0 0 20px;" onclick="followPush();"><i
                                class="fas fa-rss"></i></span>

                        <span id="hideavatar" style="float:right;padding:0 20px 0 20px;"
                            onclick="togglehideavatar(true);"><i class="fas fa-images"></i></span>
                    </div>

                    <br>
                    <hr style="margin:0px 0 4px 0;border-top:2px solid #eee">

                    <div class='container'>
                        <div class="row">
                            <form class="form-inline w-100 m-0">
                                <div class="input-group w-100">
                                    <textarea onfocus="followPush();" class="form-control textzoom" zoom-force="true"
                                        zoom-save="newcmt" id="cmtx" style="font-size:14px"
                                        placeholder="Nhập bình luận. Cảnh báo: nghiêm cấm vô não chửi bậy, chửi liên quan đến thể loại truyện, mô típ của truyện, bối cảnh của truyện. Nghiêm cấm bình luận chống lại nhà nước, danh nhân lịch sử, người vi phạm sẽ bị khóa tài khoản tùy mức độ."></textarea>
                                    <div class="input-group-append">
                                        <button type="button" class="btn btn-info"
                                            style="max-height:60px;font-size:16px;" onclick='sendcmt()'>Gửi</button>
                                    </div>
                                </div>
                                <form>
                        </div>
                    </div>
                    <div id="replycmtwd" style="display:none">
                        <input id="replycmt"><button type="button" style="height:30px"
                            onclick="sendreply()">Gửi</button>
                    </div>
                    <div id="cmtwd" style="font-size:16px;line-height:1.2;width:100%;margin-top: 16px;" data-start="0">
                        <center><button class="btn btn-secondary w-100" type="button" onclick="loadCmt()">Xem bình
                                luận</button></center>
                    </div>
                    <style type="text/css">
                        #commentportion .sec-top {
                            max-height: 250px;
                            overflow: hidden;
                        }

                        .excmt:empty {
                            display: none;
                        }

                        .sec-bot a {
                            max-width: 50vw;
                            text-overflow: ellipsis;
                            white-space: nowrap;
                            overflow: hidden;
                            display: inline-block;
                            vertical-align: middle;
                        }
                    </style>
                    <script>
                        var topcmt = g("cmtwd");
                        window.ui && ui.autoresize(g("cmtx"));
                        function loadCmt() {
                            if (document.hidden === true && !document.referrer) { return; }
                            var startcmt = parseInt(g("cmtwd").getAttribute("data-start"));
                            ajaxUrl("/io/comment/webComments", "start=" + startcmt + "&objectid=100464209&objecttype=ciweimao", function (rsp) {
                                var w = g("cmtwd");
                                w.id = "";
                                w.innerHTML = rsp;
                                var timeelap = q(".timeelap");
                                timeelap.forEach(function (e) {
                                    e.innerHTML = timeElapsed(e.innerHTML, true);
                                });
                                var cmtlist = q("#commentportion .sec-top");
                                cmtlist.forEach(function (e) {
                                    if (e.scrollHeight > 240) {
                                        ui.expand(e);
                                    }
                                });
                            });
                        }
                        function togglehideavatar(toggle) {
                            var boo = getCookie("hideavatar") == "true";
                            if (toggle) {
                                boo = !boo;
                            }
                            window.userstyle = window.userstyle || ui.style.create();
                            if (boo) {
                                var d = new Date();
                                d.setTime(d.getTime() + (365 * 24 * 60 * 60 * 1000));
                                document.cookie = "hideavatar=true; path=/; expires=" + d.toUTCString();
                                g("hideavatar").style.filter = "blur(2px)";
                                window.userstyle.set("#commentportion img", "width: 0px;border:none;margin-right:-6px;");
                            } else {
                                var d = new Date();
                                d.setTime(d.getTime() + (365 * 24 * 60 * 60 * 1000));
                                document.cookie = "hideavatar=false; path=/; expires=" + d.toUTCString();
                                g("hideavatar").style.filter = "none";
                                window.userstyle.set("#commentportion img", "");
                            }
                            window.userstyle.use();
                        }
                        try {
                            togglehideavatar();
                        } catch (e) { }
                        var pushserver = false;
                        function followPush() {
                            g("livecomment").style.color = "green";
                            g("livecomment").setAttribute("onclick", "");
                            var channelid = "cmt-ciweimao-100464209";
                            var ws = pushserver;
                            if (ws && ws.readyState != 3) {
                                return;
                            } else
                                ws = new WebSocket("wss://push.sangtacvietcdn.xyz/");
                            pushserver = ws;
                            ws.onopen = function () {
                                ws.send("connect " + channelid);
                            }
                            ws.onmessage = function (mes) {
                                var upd = JSON.parse(mes.data);
                                if (upd.type == "new") {
                                    var cmtpt = q('[data-start="0"]')[0];
                                    var a = document.createElement('div');
                                    a.innerHTML = upd.data;
                                    cmtpt.insertBefore(a.children[0], cmtpt.children[0]);
                                    setTimeout(function () {
                                        $(cmtpt.children[0]).hide().fadeIn();
                                    }, 50);
                                } else if (upd.type == "del") {
                                    var cmt = q('[cmtid="' + upd.cmtid + '"]')[0];
                                    if (cmt) {
                                        $(cmt.parentElement.parentElement.parentElement).fadeOut();
                                    }
                                } else if (upd.type == "reply") {
                                    var cmt = q('[cmtid="' + upd.cmtid + '"]')[0];
                                    if (cmt) {
                                        cmt = cmt.parentElement.parentElement.parentElement;
                                        while (cmt.nextElementSibling) {
                                            if (cmt.nextElementSibling.children[0].style.marginLeft == "") {
                                                break;
                                            }
                                            cmt = cmt.nextElementSibling;
                                        }
                                        var a = document.createElement('div');
                                        a.innerHTML = upd.data;
                                        a = a.children[0];
                                        cmt.parentElement.insertBefore(a, cmt.nextElementSibling);
                                        setTimeout(function () {
                                            $(a).hide().fadeIn();
                                        }, 50);
                                    }
                                }
                            }
                        }
                        var issending = false;
                        function sendcmt() {
                            if (issending) return;
                            var content = g("cmtx").value;
                            if (content.length < 3) {
                                alert("Độ dài tối thiểu 3 kí tự");
                            }
                            else {
                                try { g("livecomment").click(); } catch (excep) { }

                                issending = true;
                                var http = new XMLHttpRequest();
                                var url = '/index.php?ngmar=postcomment';
                                var params = "ajax=postcomment&bookid=100464209&host=ciweimao"; params += "&content=" + encodeURIComponent(content);
                                http.open('POST', url, true);
                                http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                                http.onreadystatechange = function () {
                                    if (http.readyState == 4 && http.status == 200) {
                                        issending = false;
                                        if (http.responseText.indexOf("success") >= 0) {
                                            g("cmtx").value = "";
                                            topcmt.innerHTML = http.responseText.substring(7) + topcmt.innerHTML;

                                        }
                                        else {
                                            if (http.responseText == "login") {
                                                openloginmodal();
                                            } else {
                                                alert(http.responseText);
                                            }
                                        }
                                    }
                                }
                                http.send(params);
                            }
                        }
                        var repid, repname;
                        var repcmtmd;
                        var issendlock = false;
                        function reply(a, b, c, d) {
                            //var w=g("replycmtwd");
                            if (repcmtmd == null) {
                                repcmtmd = createModal("Trả lời bình luận");
                                repcmtmd.button("Gửi bình luận", "sendreply()", "btn-primary");
                            }
                            repcmtmd.hide = function () {
                                $(this.children[0]).modal('hide');
                            }
                            var w = repcmtmd.body();
                            if (w.children.length == 0) {
                                w.innerHTML = "<textarea onfocus='followPush()' id='repcmtta' style='min-height:160px;width:100%;font-size:16px;' placeholder='Nhập nội dung.'></textarea>";
                                ui.zoomText(w.children[0], null, "repcmt", true);
                            }
                            document.body.appendChild(repcmtmd);
                            //w.style.display="block";
                            if (typeof d != "undefined") {
                                var tagged = "@[" + d + "]" + b + "[/] ";
                                if (g("repcmtta").value.indexOf(tagged) == 0) {
                                    repcmtmd.show();
                                    issendlock = true;
                                    setTimeout(function () {
                                        g("repcmtta").focus();
                                    }, 500);
                                    setTimeout(function () {
                                        issendlock = false;
                                    }, 800);
                                    return;
                                } else {
                                    g("repcmtta").value = tagged;
                                    issendlock = true;
                                    setTimeout(function () {
                                        g("repcmtta").focus();
                                    }, 500);
                                    setTimeout(function () {
                                        issendlock = false;
                                    }, 800);
                                }
                            }
                            else {
                                var tagged = "@" + b + " ";
                                if (g("repcmtta").value.indexOf(tagged) == 0) {
                                    repcmtmd.show();
                                    g("repcmtta").focus();
                                    return;
                                } else {
                                    g("repcmtta").value = tagged;
                                }
                                g("repcmtta").value = "@" + b + " ";
                            }
                            //c.parentElement.appendChild(w);
                            repcmtmd.show();
                            g("repcmtta").focus();
                            repid = a;
                        }
                        function sendreply() {
                            if (issending || issendlock) return;
                            var content = g("repcmtta").value;
                            if (content.length < 3) {
                                alert("Độ dài tối thiểu 3 kí tự");
                            }
                            else {
                                try { g("livecomment").click(); } catch (excep) { }
                                issending = true;
                                var http = new XMLHttpRequest();
                                var url = '/index.php';
                                var params = "ajax=replycomment&cid=" + repid;
                                params += "&content=" + encodeURIComponent(content);
                                http.open('POST', url, true);
                                http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                                http.onreadystatechange = function () {
                                    if (http.readyState == 4 && http.status == 200) {
                                        if (http.responseText.indexOf("success") >= 0) {
                                            g("repcmtta").value = "";
                                            repcmtmd.hide();
                                            issending = false;
                                        }
                                        else {
                                            if (http.responseText == "login") {
                                                openloginmodal();
                                            } else {
                                                alert(http.responseText);
                                            }
                                        }
                                    }
                                }
                                http.send(params);
                            }
                        }
                        function r() {
                            return;
                            var http = new XMLHttpRequest();
                            var url = '/index.php?ngmar=readcounter';
                            var params = "sajax=read";
                            http.open('POST', url, true);
                            http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                            http.onreadystatechange = function () {
                            }
                            http.send(params);
                        }

                        function delcmt(btn) {
                            var cmtid = btn.parentElement.getAttribute("cmtid");
                            if (confirm("Xóa bình luận " + cmtid + "?"))
                                ajax("ajax=delcmt&cid=" + cmtid, function (down) {
                                    q("[cmtid=\"" + cmtid + "\"]")[0].parentElement.parentElement.style.border = "2px solid #ff7878";
                                });
                        }
                    </script>
                    <br>
                    <div hidden="" style="width: 100%;">
                        <br><br>
                        BÌNH LUẬN FACEBOOK<br>
                        <div id="fb-root"></div>
                        <div id="comments" class="fb-comments" data-href="" data-width="100%" data-numposts="8"></div>
                        <script type="text/javascript">
                            function loadFacebookComment() {
                                var js = document.createElement('script');
                                js.src = '//connect.facebook.net/vi_VN/sdk.js#xfbml=1&appId=272682774363008&version=v10.0';
                                document.body.appendChild(js);
                                g("showFBCmtBtn").remove();
                            }
                        </script>
                        <center id="showFBCmtBtn"><button class="btn btn-secondary w-100" type="button"
                                onclick="loadFacebookComment()">Xem bình luận facebook</button></center>
                    </div>
                    <br><br>
                    <center style="width:100%"><button id="show-per-book" data-target="perbookcmt"
                            class="btn btn-primary w-100" type="button" style="display: none;margin-top: 40px">Xem bình
                            luận từ nguồn truyện</button></center>
                    <div style="margin-top: 30px;width: 100%" class="excomment" id="perbookcmt"></div>
                    <script>window.enableExternalComment = true;</script>
                    <script src="/stv.excomment.js?v=26"></script>

                </div>
                <br><br>

            </div>
        </div>
    </div>
    <div id="tm-credit-section" class="container-fluid bg-dark">
        <div class="container">
            <div id="credit" class="row" style="font-size:12px;">
                <center id="tm-credit-text" style="clear:both;width: 100%;color: white;padding: 24px;">
                    <a href="/">
                        <div
                            style="display: inline-block;margin-right: -165px;width: 158px;border-radius: 6px;color: white;height: 56px;background: whitesmoke">
                        </div>
                        <img alt="Logo sangtacviet" loading=lazy src="/favicon.png"
                            style="width: 160px;margin-top: -48px">
                    </a><br>
                    sangtacviet.com là trang web cung cấp dịch vụ dịch tự động dịch truyện chữ trung. <br>
                    <div style="margin-bottom: 6px;">
                        <a href="/manhtan.pdf">Hướng dẫn tân thủ</a>
                        <a href="/@0">Bài viết</a>
                        <a href="/~app-doc-truyen-phien-ban-thu-nghiem-101">App</a>
                        <a href="/~extension-dich-thuat-tu-dong-tieng-trung-v150">Extension</a>
                        <a href="javascript:showLangSelect()">Chọn ngôn ngữ</a>
                    </div>

                    <span style="border-radius: 6px;background: #eee;display: inline-block;padding: 6px;">
                        <!-- BEGIN: Powered by Supercounters.com -->
                        <script async onload="sc_online_t(1546820, ' Online', '170ddb');" defer type="text/javascript"
                            src="/supercounters.php?v4" ssrc="//widget.supercounters.com/ssl/online_t.js"></script>
                        <script type="text/javascript"></script>
                        <br>
                        <noscript><a href="https://my.ipaddress.is/">What is my ip address</a></noscript>
                        <!-- END: Powered by Supercounters.com -->

                    </span><br>
                    <a hidden="" href="//www.dmca.com/Protection/Status.aspx?ID=86c08fad-8058-44e7-a411-4e384995c6d5"
                        title="DMCA.com Protection Status" class="dmca-badge"> <img
                            src="https://images.dmca.com/Badges/dmca_protected_sml_120n.png?ID=86c08fad-8058-44e7-a411-4e384995c6d5"
                            alt="DMCA.com Protection Status" /></a>
                    <scripts src="https://images.dmca.com/Badges/DMCABadgeHelper.min.js"> </scripts>
                </center>
                <br>

            </div>
        </div>
    </div>
    <div id="namewdf" style="visibility:hidden;height:auto;" onkeydown="event.stopPropagation();" class='namewd'>
        <div id="toolbar">

            <button type="button" class='toolbar' onclick="saveNS()">Lưu lại</button>
            <button type="button" class='toolbar' onclick="saveNS();excute();">Chạy</button>
            <button type="button" class='toolbar' onclick="clearNS()">Xóa hết</button>
            <button type="button" class='toolbar' onclick="getNSOnline()">Tải name</button>
            <button type="button" class='toolbar' onclick="uploadNS()">Upload</button>
            <button type="button" class='toolbar' style="float:right" onclick="hideNS()">Ẩn</button>

        </div>
        <div id="toolbar2" style="display:none;">
            <button type="button" class='toolbar'
                onclick="this.parentElement.style.display='none';g('toolbar').style.display='block';g('dlnametb').style.zIndex='-1';"><span
                    class='glyphicon glyphicon-chevron-left'></span>Quay lại</button>
            <button type="button" class='toolbar' style="float:right" onclick="hideNS()">Ẩn</button>
        </div>
        <hr style="margin:0;clear:both">
        <div id="namewdc" style="position:relative">
            <textarea id="namewd"></textarea>
            <div id="dlnametb"
                style="z-index:-1;position:absolute;top:0;left:0;width:100%;height:100%;background-color:white;max-height:269px;overflow-y:auto;">
                <table id="dlnametbcontent"></table>
            </div>

            <div id="upnamewd"
                style="z-index:-1;position:absolute;top:0;left:0;width:100%;height:100%;background-color:white;">
                <br>
                <center><input class="nip" id="uploaduser" placeholder="Nhập tên của bạn"><br>
                    <br>
                    <button class="btn btn-primary" type="button" id="sendnsbt"
                        onclick="this.disabled=true;sendNS()">Gửi</button>&nbsp;<button class="btn btn-secondary"
                        type="button" onclick="this.parentElement.parentElement.style.zIndex='-1'">Hủy</button><br>
                </center>
            </div>
        </div>

        <div hidden style="width:100%;border-top:1px solid black">
            <input id="fastseltext" onpaste="fastCreateN(this)" onkeyup="fastCreateN(this)"
                style="float:left;width:40%;height:24px;font-size:16px;" type="text"><span
                style="float:left;">&nbsp;=&nbsp;</span><input style="float:left;width:40%;height:24px;font-size:16px;"
                id="fastgentext">
            <button type="button" class="toolbar" style="float:right;margin: 0;padding: 0;" onclick="fastAddNS()">Thêm
            </button>
            <div class='clear'></div>
        </div>
        <div style="border-top:1px solid gray;" class="row justify-content-md-left m-0">
            <div class="col-3"><span onclick="excute()" class="blk-item2"><i class="fas fa-play"
                        style="color:green;"></i><br>Chạy</span></div>
            <div class="col-3"><span onclick="getNSOnline()" class="blk-item2"><i class="fas fa-cloud-download"
                        style="color:green;"></i><br>Tải name được chia sẻ</span></div>
            <div class="col-3"><span onclick="importName()" class="blk-item2"><i class="fas fa-file-import"></i><br>Nhập
                    dữ liệu name</span></div>
            <div class="col-3"><span onclick="openinsertvpmodal()" class="blk-item2"><i
                        class="fas fa-file-alt"></i><br>Sử dụng file vp riêng</span></div>
            <div class="col-3"><span onclick="exportName()" class="blk-item2"><i class="fas fa-file-export"></i><br>Xuất
                    dữ liệu</span></div>
            <div class="col-3"><span onclick="uploadNS()" class="blk-item2"><i class="fas fa-upload"></i><br>Chia sẻ gói
                    name</span></div>
            <div class="col-3"><span onclick="var wd=ui.win.createBox('Gói Name Đặc Biệt','namepack').show();"
                    onclicks="$('#customnamebox').modal('toggle')" class="blk-item2"><i class="fas fa-download"
                        style="color:green;"></i><br>Tải name đặc biệt</span></div>
            <div class="col-3"><span onclick="analyzer.reset();" class="blk-item2"><i class="fas fa-trash-alt"
                        style="color:red;"></i><br>Xóa bộ nhớ Analyzer</span></div>
            <div class="col-3"><span onclick="ui.win.createBox('Công cụ','tool').show()" class="blk-item2"><i
                        class="fas fa-wrench"></i><br>Công cụ</span></div>
            <div class="col-3" hidden><span onclick="TFCoreTranslatePage()" class="blk-item2"><i
                        class="fas fa-magic"></i><br>Transform</span></div>
        </div>
    </div>

    </div>
    <div id="configBox" class="bg-light"
        style="position: fixed;bottom: 75px;right: 65px;border: 1px solid #cccbcb;display: none;">
        <div>
            <div id="stylediv" style="line-height:1.5;user-select: none;padding: 5px"
                onclick="event.stopPropagation();">
                Màu nền: <input type="color" style="float: right;height: 20px;width:50px;"
                    oninput="this.style.backgroundColor=this.value;changebg(this)">
                <br>
                <span class="cgcolor" style="background-color:#eae4d3" onclick="changebg(this)">A</span>
                <span class="cgcolor" style="background-color:#ffffff" onclick="changebg(this)">A</span>
                <span class="cgcolor" style="background-color:#000000" onclick="changebg(this)">A</span>
                <span class="cgcolor" style="background-color:#d0d0d0" onclick="changebg(this)">A</span>
                <span class="cgcolor" style="background-color:#a3e6a2" onclick="changebg(this)">A</span>
                <span class="cgcolor" style="background-color:#a7d4e8" onclick="changebg(this)">A</span>
                <span class="cgcolor" style="background-color:#d7ffff" onclick="changebg(this)">A</span><br>
                <span class="cgcolor" style="background-color:#8a8a88" onclick="changebg(this)">A</span>
                <span class="cgcolor" style="background-color:#fbdada" onclick="changebg(this)">A</span>
                <span class="cgcolor" style="background-color:#6f3333" onclick="changebg(this)">A</span>
                <span class="cgcolor" style="background-color:#5cbd94" onclick="changebg(this)">A</span>
                <span class="cgcolor" style="background-color:#c492de" onclick="changebg(this)">A</span>
                <span class="cgcolor" style="background-color:#127743" onclick="changebg(this)">A</span>
                <span class="cgcolor" style="background-color:#ececec" onclick="changebg(this)">A</span><br>
                Màu chữ: <span style="float:right;padding-right:55px;height:20px;">
                    <span>Bóng:</span>
                    <input id="none-1e129e" type="checkbox" style="height: 20px;-webkit-appearance: checkbox;"
                        onchange="changetextshadow(this.checked,1)">
                    <input id="none-35a49y" type="color" style="height: 20px;position:absolute;right:5px;width:50px;"
                        oninput="changetextshadow(this.value,2)">

                </span><br>
                <span class="cgcolor" style="color:#eae4d3" onclick="changebgx(this)">A</span>
                <span class="cgcolor" style="color:#ffffff" onclick="changebgx(this)">A</span>
                <span class="cgcolor" style="color:#000000" onclick="changebgx(this)">A</span>
                <span class="cgcolor" style="color:#d0d0d0" onclick="changebgx(this)">A</span>
                <span class="cgcolor" style="color:#a3e6a2" onclick="changebgx(this)">A</span>
                <span class="cgcolor" style="color:#a7d4e8" onclick="changebgx(this)">A</span>
                <span class="cgcolor" style="color:#d7ffff" onclick="changebgx(this)">A</span><br>
                <span class="cgcolor" style="color:#8a8a88" onclick="changebgx(this)">A</span>
                <span class="cgcolor" style="color:#fbdada" onclick="changebgx(this)">A</span>
                <span class="cgcolor" style="color:#6f3333" onclick="changebgx(this)">A</span>
                <span class="cgcolor" style="color:#5cbd94" onclick="changebgx(this)">A</span>
                <span class="cgcolor" style="color:#c492de" onclick="changebgx(this)">A</span>
                <span class="cgcolor" style="color:#127743" onclick="changebgx(this)">A</span>
                <span class="cgcolor" style="color:#ececec" onclick="changebgx(this)">A</span><br>
                <center>
                    <span style="padding:6px;border-radius:6px;" onclick="decreaseFontsize()"><i
                            class="fas fa-minus"></i> </span><span style="margin-right: -20px;position: relative;"><img
                            loading=lazy src="/asset/Aa.png" style="width: 18px;
    height: 20px;"></span><input id="changefs" style="max-width:45px;padding: 3px;padding-left:20px;"
                        onchange="changefontsize(this);" value="24"><span style="padding:6px;border-radius:6px;"
                        onclick="increaseFontsize()"><i class="fas fa-plus"></i></span>
                    <span style="padding:6px;border-radius:6px;" onclick="decreaseLineheight()"><i
                            class="fas fa-minus"></i> </span><span style="margin-right: -15px;position: relative"><img
                            loading=lazy src="/asset/lh.png" style="    width: 12px;
    height: 28px;"></span><input id="changefs2" style="max-width:45px;padding: 3px;padding-left: 15px;"
                        onchange="changelineheight(this);" value="1.2"><span style="padding:6px;border-radius:6px;"
                        onclick="increaseLineheight()"><i class="fas fa-plus"></i></span>
                </center>
                <select id="selfont" value="arial" style="border-radius: 0;background: white;width: 100%;">
                    <option value='helvetica'>Helvetica</option>
                    <option value='opensans'>Open Sans</option>
                    <option value='stvverdana'>Verdana</option>
                    <option value='roboto'>Roboto</option>
                    <option value='stvarial'>Arial</option>
                    <option value='stvtahoma'>Tahoma</option>
                    <option value='palatinolinotype'>Palatino linotype</option>
                    <option value='nunito'>Nunito</option>
                    <option value='sourceserifpro'>Source Serif Pro</option>
                    <option value='robotoslab'>Roboto Slab</option>

                </select>
                <center style="font-size: 22px">
                    <span style="display: inline-block;border:1px solid gray;padding: 4px"
                        onclick="decreasepadding()"><i class="fas fa-outdent"></i></span>
                    <span val="left" style="display: inline-block;border:1px solid gray;padding: 4px"
                        onclick="changealign(this)"><i class="fas fa-align-left"></i></span>
                    <span val="center" style="display: inline-block;border:1px solid gray;padding: 4px"
                        onclick="changealign(this)"><i class="fas fa-align-center"></i></span>
                    <span val="justify" style="display: inline-block;border:1px solid gray;padding: 4px"
                        onclick="changealign(this)"><i class="fas fa-align-justify"></i></span>
                    <span val="right" style="display: inline-block;border:1px solid gray;padding: 4px"
                        onclick="changealign(this)"><i class="fas fa-align-right"></i></span>
                    <span style="display: inline-block;border:1px solid gray;padding: 4px"
                        onclick="increasepadding()"><i class="fas fa-indent"></i></span>
                </center>
                <script>
                    g("selfont").onchange = function () {
                        try {
                            g(contentcontainer).style.fontFamily = this.value;
                            localStorage.setItem("fontfamily", this.value);
                        } catch (e) { }
                    }
                    function changetextshadow(v, i) {
                        if (i == 1) {
                            try {
                                if (v) {
                                    var c = event.target.nextElementSibling.value;
                                    if (c == "#000000") {
                                        c = "0 0 1px white";
                                    }
                                    else { c = "0 0 1px " + c; }
                                    g(contentcontainer).style.textShadow = c;
                                    localStorage.setItem("textlshadow", c);
                                } else {
                                    g(contentcontainer).style.textShadow = "none";
                                    localStorage.setItem("textlshadow", "none");
                                }
                            } catch (e) { }
                        } else {
                            try {
                                var c = "0 0 1px " + v;
                                g(contentcontainer).style.textShadow = c;
                                localStorage.setItem("textlshadow", c);
                                event.target.previousElementSibling.checked = true;
                            } catch (e) { }
                        }
                    }
                </script>
                </center>
            </div>
        </div>
        <div class="bg-dark" style="display: flex;">
            <button type="button" onclick="speaker.readBook()"
                style="background: none;border:none;color: white;font-size: 16px;padding: 6px;"><i
                    class="fas fa-play"></i> Nghe sách</button>
            <button type="button" onclick="showNS()"
                style="background: none;border:none;color: white;font-size: 16px;padding: 6px;"><i
                    class="fas fa-edit"></i> Name</button>
        </div>
    </div>
    <button type="button" id="btnshowns" aria-label="Nút mở cài đặt" class='toolbar showname'
        style="border-radius: 50%;height: 50px; width: 50px;background: #eaeaea80;bottom:20px;border:none;box-shadow: 0 0 3px gray;padding: 0"
        onclick="showConfigBox()"><i class="fa-cogs fas" style="font-size: 26px;color: #6564638a;"></i></button>
    <div id="float-btn" style="width: 50px;position: fixed;right: 14px;bottom: 85px;">
        <button type="button" id="btnunitymode"
            style="border-radius: 50%;height: 50px; width: 50px;background: #eaeaea80;border:none;box-shadow: 0 0 3px gray;padding: 0;opacity: 1;display: none;"
            onclick="ui.unity()"><i class="fas fa-eye" style="font-size: 26px;color: #6564638a;"></i></button>
    </div>

    <button type="button" id="btnnextchapter" class='toolbar showname'
        style="border-radius: 50%;height: 50px; width: 50px;opacity: 0;bottom:20px;border:none;box-shadow: 0 0 3px gray;padding: 0;right: 75px;display: none"
        onclick="g('navnexttop').click()"><i class="fas fa-chevron-right"
            style="font-size: 26px;color: #6564638a;"></i></button>
    <button type="button" id="btnprevchapter" class='toolbar showname'
        style="border-radius: 50%;height: 50px; width: 50px;opacity: 0;bottom:20px;border:none;box-shadow: 0 0 3px gray;padding: 0;right: 140px;display: none"
        onclick="g('navprevtop').click()"><i class="fas fa-chevron-left"
            style="font-size: 26px;color: #6564638a;"></i></button>

    <script>
        function online() {
            //return;
            var lastol = localStorage.getItem("lastonline");
            if (lastol && lastol.length > 0) {
                var ctime = new Date().getTime() / 1000;
                if (ctime - parseInt(lastol) < 60) {
                    setTimeout(online, 15000);
                    return;
                }
            }
            var params = "sajax=online&ngmar=ol";
            var http = new XMLHttpRequest();
            var url = '/io/user/online?ngmar=ol2&u=329882';
            http.open('POST', url, true);
            http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            http.onreadystatechange = function () {
                if (http.readyState == 4 && http.status == 200) {
                    if (http.responseText != "0") {
                        if (http.responseText == "Bạn chưa đăng nhập!") {
                            //location.reload();
                        } else
                            g("notifmarker").setAttribute("havenotif", http.responseText);
                    } else {
                        g("notifmarker").removeAttribute("havenotif");
                    }
                    setTimeout(online, 300000);
                } else if (http.readyState == 4 && http.status != 502) {
                    setTimeout(online, 300000);
                }
            }
            http.send(params);
            var ctime2 = new Date().getTime() / 1000;
            localStorage.setItem("lastonline", "" + ctime2);
        }
        setTimeout(online, 15000);
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-145395004-1"
        onerror="this.src='/gtag.php'"></script>
    <scripts async defer src="/gtag.php?123" onerror="this.src='/gtag.php?456'"></scripts>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'UA-145395004-1');

        q("span[tag]").forEach(function (e) {
            e.title = e.textContent;
        });
        try {
            if ($("#mainbar").height() > 150) {
                g("notifmarker").innerHTML = "Thông báo";
                g("menunavigator2").insertBefore(g("notifmarker"), g("menunavigator2").children[1]);
            }
        } catch (e) { }
        (function () {
            var _open = window.open;
            window.open = function () {
                var blockedDomain = ["vjnycjpjg.com", "vgthxbor.com", "ascynbdhkpyci.com", "qmnemxade.com", "rwhhcwku.com", "oriwehdqf.com", "wgkisvpild.com", "gysloflobxsrti.com"
                    , "ilrdvouqmynwt.com", "ruktosjegndci.com", "gletsokr.com", "uxvbofhyq.com"];
                for (var i = 0; i < blockedDomain.length; i++) {
                    if (arguments[0].indexOf(blockedDomain[i]) >= 0) {
                        return false;
                    }
                }
                console.log(arguments);
                _open.apply(window, arguments);
            }
        })()
        function setSiteLang(l) {
            var d = new Date();
            d.setTime(d.getTime() + (365 * 24 * 60 * 60 * 1000));
            var expires = "expires=" + d.toUTCString();
            document.cookie = "lang=" + l + ";" + expires + ";path=/";
        }
        function showLangSelect() {
            var s = ui.select("Chọn ngôn ngữ/Select language");
            var ls = [{
                l: "vi",
                n: "Tiếng Việt"
            }, {
                l: "en",
                n: "English"
            }, {
                l: "zh",
                n: "中文"
            }, {
                l: "ar",
                n: "اَلْعَرَبِيَّةُ"
            }];
            ls.forEach(function (lg) {
                s.option(lg.l, lg.n);
            });
            s.proc = function (v) {
                setSiteLang(v);
                setTimeout(function () { location.reload() }, 1000);
                s.hide();
            }
            s.show();
        }

    </script>
    <script data-cfasync="false" type="text/javascript"
        src="//o6z2a2kq8fatj3ch0x5ow6v82ha2gja8x8c7w6pc5gx2ls0zia7bx1n28b5d.com/e8zj2v9sg6x8aw5jf0x7xj1g68ajcg1x9cj0mhs9znx7fuaw5jfavhaw5xja2xjwt3v0b1xolw6jhfb7dt5m.js"></script>
    <script
        type="text/javascript">document.write(ghz.yz6vqp2w0xg7qivt6qxhwm("PHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iLy9vNnoyYTJrcThmYXRqM2NoMHg1b3c2djgyaGEyZ2phOHg4Yzd3NnBjNWd4MmxzMHppYTdieDFuMjhiNWQuY29tL2I4emo1YTJrNngwd3U2c3U3ZXUyYW0wd2hvOGV2N2hhL3M1YTNuZzR0YTdjdjhpOWV0eHk1cmZhc2locTlyZmFzaGZzamE4eGFzaHgvejloZmF0aGphc3Y4Y2h6eGY3aC5waHAiPjwvc2NyaXB0Pg=="));</script>
</body>